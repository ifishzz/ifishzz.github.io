<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<meta name="author" content="ifish">
		
		<meta name="generator" content="Hugo 0.54.0" />
		<title>hugo and travis automation deploy &middot; if1sh</title>
		<link rel="shortcut icon" href="https://ifishzz.github.io//images/favicon.ico">
		<link rel="stylesheet" href="https://ifishzz.github.io//css/style.css">
		<link rel="stylesheet" href="https://ifishzz.github.io//css/highlight.css">

		
		<link rel="stylesheet" href="https://ifishzz.github.io//css/font-awesome.min.css">
		

		
		<link href="https://ifishzz.github.io/index.xml" rel="alternate" type="application/rss+xml" title="if1sh" />
		

		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='https://ifishzz.github.io/'> <span class="arrow">←</span>Home</a>
	
	<a href='https://ifishzz.github.io//posts'>Archive</a>
	
	<a href='https://ifishzz.github.io//categories'>Cate</a>
	<a href='https://ifishzz.github.io//links'>Link</a>

	<a href='https://ifishzz.github.io//about'>About</a>

	

	
	<a class="cta" href="https://ifishzz.github.io/index.xml">Subscribe</a>
	
</nav>


        <section id="wrapper" class="post">
            <article>
                <header>
                    <h1>
                        hugo and travis automation deploy
                    </h1>
                    <h2 class="headline">
                    Jan 3, 2019 00:00
                    · 788 words
                    · 2 minute read
                      <span class="tags">
                      
                      
                          
                              <a href="https://ifishzz.github.io//tags/hugo">hugo</a>
                          
                              <a href="https://ifishzz.github.io//tags/travis">travis</a>
                          
                      
                      
                      </span>
                    </h2>
                </header>
                
                  
                    <div id="toc">
                      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#0x00-准备工作">0x00 准备工作</a></li>
<li><a href="#0x01-travis设置">0x01 travis设置</a></li>
<li><a href="#0x02-travis脚本设置">0x02 travis脚本设置</a></li>
<li><a href="#0x03-本地构建hugo">0x03 本地构建hugo</a></li>
<li><a href="#0x04-自定义域名">0x04 自定义域名</a></li>
<li><a href="#0x05-参考资料">0x05 参考资料</a></li>
</ul></li>
</ul>
</nav>
                    </div>
                  
                
                <section id="post-body">
                    

<h2 id="0x00-准备工作">0x00 准备工作</h2>

<p>repo：blog-hugo<br />
github-page：ifishzzz.github.io</p>

<h2 id="0x01-travis设置">0x01 travis设置</h2>

<p><a href="https://github.com/settings/tokens">https://github.com/settings/tokens</a> 先在github生成一个token，勾选第一个回购,注意token只能看一次</p>

<p>进入travis勾选blog-hugo这个repo,并且点击设置</p>

<p>拉到下面填写变量名与token值，比如变量是github_token，把github_token值输入进去,add</p>

<h2 id="0x02-travis脚本设置">0x02 travis脚本设置</h2>

<p>在code目录创建.travis.yml</p>

<pre><code>install:
    - uname -a #没用
    #可以有多种安装hugo的方式，可以参考下别人的脚本
    - wget https://github.com/gohugoio/hugo/releases/download/v0.45.1/hugo_0.45.1_Linux-64bit.deb
    - sudo dpkg -i hugo*.deb
    - hugo version #没用
    - ls #没用
    - pwd #没用

script:
    - git submodule foreach git pull origin master #这句不知道什么意思
    - hugo #生成静态页面
    - echo 'Hugo build done!' #没用
after_script:
  - git clone &quot;https://ifishzzz:${githubtoken}@${Github_REF}&quot; github-pages #填入你的名字，以及travis的变量名，克隆gitpage页面
  - cp ./public/* github-pages -rf #本地生成的静态页面cp进gitpage
  - cd github-pages #进入gitpage，hugo上传只需要上传静态页面
  - git add . #gitpage是clone下来的不用git init
  - git commit -m &quot;Update Blog By TravisCI With Build $TRAVIS_BUILD_NUMBER&quot;
  - git tag v0.0.$TRAVIS_BUILD_NUMBER -a -m &quot;Auto Taged By TravisCI With Build $TRAVIS_BUILD_NUMBER&quot; #没用
  # Github Pages
  - git push --force --quiet &quot;https://ifishzzz:${githubtoken}@${Github_REF}&quot; master:master
  - git push --quiet &quot;https://ifishzzz:${githubtoken}@${Github_REF}&quot; master:master --tags
  # deploy: #没软用，其他的假教程说有用
  # local_dir: public # Default static site output dir for Hugo
  # repo: tainzhi/tainzhi.github.io # This is the slug of the repo you want to deploy your site to
  # target_branch: master # GitHub pages branch to deploy to (in other cases it can be gh-pages)
  # provider: pages
  # skip_cleanup: true
  # github_token: $GithubToken # This is the authentication which you will setup in the next step in travis-ci dashboard
  # email: qfq61@qq.com
  # name: &quot;qfq&quot;
  # on:
    # branch: master

env:
 global:
   # Github Pages
   - Github_REF: github.com/ifishzzz/ifishzzz.github.io.git #配置变量
</code></pre>

<h2 id="0x03-本地构建hugo">0x03 本地构建hugo</h2>

<p>测试没问题，把整个网站推到blog-hugo这个repo</p>

<pre><code>git init
git remote add origin https://github.com/ifishzzz/blog-hugo.git
git status
git add .
git commit -m 'code'
git push -u origin master
</code></pre>

<p>travis网站会自动检测，可以看脚本运行状态，自动部署完成后，然后就可以打开ifishzzz.github.io访问啦</p>

<h2 id="0x04-自定义域名">0x04 自定义域名</h2>

<ol>
<li>域名解析</li>
</ol>

<table>
<thead>
<tr>
<th>hostname</th>
<th>type</th>
<th>address</th>
</tr>
</thead>

<tbody>
<tr>
<td>@</td>
<td>a</td>
<td>185.199.110.153</td>
</tr>

<tr>
<td>www</td>
<td>cname</td>
<td>ifishzzz.github.io</td>
</tr>
</tbody>
</table>

<ol>
<li><p>进入github repo setting 加入自定义域名,强制https</p></li>

<li><p>在gihub repo 添加一个CNAME文件,填写域名if1sh.com</p></li>
</ol>

<h2 id="0x05-参考资料">0x05 参考资料</h2>

<ul>
<li><a href="https://blog.olowolo.com/post/hugo-quick-start/">https://blog.olowolo.com/post/hugo-quick-start/</a></li>
<li><a href="http://hacktech.cn/2018/09/07/use-travis-ci-update-hexo-to-github-and-coding.html">http://hacktech.cn/2018/09/07/use-travis-ci-update-hexo-to-github-and-coding.html</a></li>
<li><a href="http://www.aaronxia.com/post/%E5%8D%9A%E5%AE%A2/hugo%E4%BD%BF%E7%94%A8%E5%8F%8A%E9%83%A8%E7%BD%B2/">http://www.aaronxia.com/post/%E5%8D%9A%E5%AE%A2/hugo%E4%BD%BF%E7%94%A8%E5%8F%8A%E9%83%A8%E7%BD%B2/</a></li>
<li><a href="http://qfq.coding.me/post/hugo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A22/">http://qfq.coding.me/post/hugo%E6%90%AD%E5%BB%BA%E5%8D%9A%E5%AE%A22/</a></li>
<li><a href="https://juejin.im/post/5a1fa30c6fb9a045263b5d2a">https://juejin.im/post/5a1fa30c6fb9a045263b5d2a</a></li>
</ul>

                </section>
            </article>

            
                

            

            

            

            <footer id="footer">
    
    
    <p class="small">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/ifishzz">ifish</a>
    </p>
</footer>

        </section>

        <script src="https://ifishzz.github.io//js/jquery-3.3.1.min.js"></script>
<script src="https://ifishzz.github.io//js/main.js"></script>
<script src="https://ifishzz.github.io//js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




  



<script>
var baiduAnalytics = '';
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?" + baiduAnalytics;
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


    </body>
</html>
