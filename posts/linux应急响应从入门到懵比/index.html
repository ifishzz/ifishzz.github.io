<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<meta name="author" content="ifish">
		
		<meta name="generator" content="Hugo 0.54.0" />
		<title>linux应急响应从入门到懵比 &middot; if1sh</title>
		<link rel="shortcut icon" href="https://ifishzz.github.io//images/favicon.ico">
		<link rel="stylesheet" href="https://ifishzz.github.io//css/style.css">
		<link rel="stylesheet" href="https://ifishzz.github.io//css/highlight.css">

		
		<link rel="stylesheet" href="https://ifishzz.github.io//css/font-awesome.min.css">
		

		

		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='https://ifishzz.github.io/'> <span class="arrow">←</span>Home</a>
	
	<a href='https://ifishzz.github.io//posts'>Archive</a>
	
	<a href='https://ifishzz.github.io//categories'>Cate</a>
	<a href='https://ifishzz.github.io//links'>Link</a>

	<a href='https://ifishzz.github.io//about'>About</a>

	

	
	<a class="cta" href="https://ifishzz.github.io/index.xml">Subscribe</a>
	
</nav>


        <section id="wrapper" class="post">
            <article>
                <header>
                    <h1>
                        linux应急响应从入门到懵比
                    </h1>
                    <h2 class="headline">
                    Feb 25, 2019 00:00
                    · 897 words
                    · 2 minute read
                      <span class="tags">
                      
                      
                          
                              <a href="https://ifishzz.github.io//tags/%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94">应急响应</a>
                          
                      
                      
                      </span>
                    </h2>
                </header>
                
                  
                    <div id="toc">
                      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#0x00-应急响应流程">0x00 应急响应流程</a></li>
<li><a href="#0x01-检测阶段">0x01 检测阶段</a></li>
<li><a href="#0x02-抑制阶段">0x02 抑制阶段</a></li>
<li><a href="#0x03-分析阶段">0x03 分析阶段</a>
<ul>
<li><a href="#web服务">web服务</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
                    </div>
                  
                
                <section id="post-body">
                    

<h2 id="0x00-应急响应流程">0x00 应急响应流程</h2>

<p>检测阶段——&gt;抑制阶段——&gt;分析阶段——&gt;恢复阶段——&gt;跟踪总结</p>

<p><strong>检测阶段</strong>
 事件类型、事件影响范围、受影响系统、事件发展趋势、安全设备等。</p>

<p><strong>抑制阶段</strong>
 物理遏制、网络遏制、主机遏制、应用遏制等。常见手段：断网、降权、网络封堵等。</p>

<p><strong>分析阶段</strong>
 系统基本信息、网络排查、进程排查、注册表排查、计划任务排查、服务排查、关键目录排查、用户组排查、事件日志排查、webshell排查、中间件日志排查、安全设备日志排查等。</p>

<p><strong>恢复阶段</strong>
 系统恢复、网络恢复、用户恢复、数据恢复以及重新部署,系统重装、补丁加固、网络恢复、密码重置、木马清除等。</p>

<p><strong>跟踪总结</strong>
 调查事件原因，输出应急响应报告，提供安全建议、加强安全教育、避免同类事件再次发生。</p>

<h2 id="0x01-检测阶段">0x01 检测阶段</h2>

<ul>
<li><p>事件类型</p>

<ul>
<li><p>Web入侵：挂马、篡改、Webshell</p></li>

<li><p>系统入侵：系统异常、RDP爆破、SSH爆破、主机漏洞</p></li>

<li><p>病毒木马：远控、后门、钓鱼、勒索软件</p></li>

<li><p>信息泄漏：脱裤、数据库登录（弱口令）、git泄漏</p></li>

<li><p>网络流量：频繁发包、批量请求、DDOS攻击、劫持、爬虫</p></li>
</ul></li>

<li><p>系统架构</p>

<ul>
<li>系统名称 IP 地址 端口开放 物理机/虚拟机 主机名 设备型号 操作系统类型</li>
<li>操作系统版本 管理后台ip地址 中间件类型 中间件版本 数据库类型 数据库版本 应用url</li>
<li>应用端口 储存设备类型 储存设备型号 web 框架 中间件版本 第三方组件</li>
</ul></li>

<li><p>受影响系统</p>

<ul>
<li>确认感染文件特征</li>
<li>确认感染时间
    - linux : stat filename(access访问时间,modify内容修改时间,change属性改变时间)
    - windows : 右键查看文件属性
<br /></li>
</ul></li>
</ul>

<h2 id="0x02-抑制阶段">0x02 抑制阶段</h2>

<ul>
<li>感染主机

<ul>
<li>网络隔离</li>
<li>禁止使用u盘,移动硬盘</li>
</ul></li>
<li>未被感染主机

<ul>
<li>ACL隔离</li>
<li>关闭ssh,rdp等协议</li>
<li>文件备份</li>
<li>禁止使用u盘,移动硬盘
<br /></li>
</ul></li>
</ul>

<h2 id="0x03-分析阶段">0x03 分析阶段</h2>

<h3 id="web服务">web服务</h3>

<ol>
<li><p>检查最近创建的php文件和上传目录</p>

<p>例如要查找24小时内被修改的php文件：</p>

<pre><code>find ./ -mtime 0 -name &quot;*.php&quot;
</code></pre>

<p>查找距现在 n*24H 内修改过的文件</p>

<pre><code>find ./ -ctime -3 
</code></pre>

<p>find三种时间</p>

<pre><code>atime 最后一次访问时间, 使用 ls -utl 可以按此时间顺序查看

ctime 最后一次状态修改时间, 使用 stat file 可以查看

mtime 最后一次内容修改时间, vim查看会更改mtime时间
</code></pre></li>

<li><p>使用Webshell查杀工具</p>

<blockquote>
<p>Windows下D盾等，Linux下河马等。</p>
</blockquote></li>

<li><p>与测试环境目录做对比</p>

<blockquote>
<p>diff -r {生产dir} {测试dir}</p>
</blockquote></li>

<li></li>
</ol>

                </section>
            </article>

            
                

            

            

            

            <footer id="footer">
    
    
    <p class="small">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/ifishzz">ifish</a>
    </p>
</footer>

        </section>

        <script src="https://ifishzz.github.io//js/jquery-3.3.1.min.js"></script>
<script src="https://ifishzz.github.io//js/main.js"></script>
<script src="https://ifishzz.github.io//js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




  



<script>
var baiduAnalytics = '';
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?" + baiduAnalytics;
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


    </body>
</html>
