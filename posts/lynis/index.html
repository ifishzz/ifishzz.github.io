<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		
		<meta name="author" content="ifish">
		
		<meta name="generator" content="Hugo 0.54.0" />
		<title>lynis安全审计 &middot; if1sh</title>
		<link rel="shortcut icon" href="https://ifishzz.github.io//images/favicon.ico">
		<link rel="stylesheet" href="https://ifishzz.github.io//css/style.css">
		<link rel="stylesheet" href="https://ifishzz.github.io//css/highlight.css">

		
		<link rel="stylesheet" href="https://ifishzz.github.io//css/font-awesome.min.css">
		

		

		
	</head>

    <body>
       <nav class="main-nav">
	
	
		<a href='https://ifishzz.github.io/'> <span class="arrow">←</span>Home</a>
	
	<a href='https://ifishzz.github.io//posts'>Archive</a>
	<a href='https://ifishzz.github.io//tags'>Tags</a>
	<a href='https://ifishzz.github.io//categories'>Cate</a>
	<a href='https://ifishzz.github.io//links'>Link</a>

	<a href='https://ifishzz.github.io//about'>About</a>

	

	
	<a class="cta" href="https://ifishzz.github.io/index.xml">Subscribe</a>
	
</nav>


        <section id="wrapper" class="post">
            <article>
                <header>
                    <h1>
                        lynis安全审计
                    </h1>
                    <h2 class="headline">
                    Jan 19, 2019 00:00
                    · 1611 words
                    · 4 minute read
                      <span class="tags">
                      
                      
                          
                              <a href="https://ifishzz.github.io//tags/lynis">lynis</a>
                          
                      
                      
                      </span>
                    </h2>
                </header>
                
                  
                    <div id="toc">
                      <nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#0x00-简介">0x00 简介</a></li>
<li><a href="#0x01-安装与运行">0x01 安装与运行</a></li>
<li><a href="#0x02-查看日志敏感信息">0x02 查看日志敏感信息</a></li>
<li><a href="#0x03-定时扫描">0x03 定时扫描</a></li>
<li><a href="#0x04-附录">0x04 附录</a></li>
</ul></li>
</ul>
</nav>
                    </div>
                  
                
                <section id="post-body">
                    

<h2 id="0x00-简介">0x00 简介</h2>

<p>可审计内容</p>

<p>1.系统上安装的二进制文件（例如/bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin目录下的）</p>

<p>2.启动服务（例如GRUB是否有密码保护)</p>

<p>3.系统内核信息（例如默认运行级别，内核加载模块，内核配置文件）</p>

<p>4.内存与进程信息（例如是否有僵尸进程，是否有等待中的I/O操作）</p>

<p>5.账户，群组与身份验证（例如sudoers文件，PAM配置等密码策略，unmask设置等）</p>

<p>6.Shell（/etc/shells）</p>

<p>7.文件系统（例如tmp目录下是否有90天前的文件，root文件系统是否有ACL策略</p>

<p>8.是否禁止外设（usb，fireware）</p>

<p>9.NFS</p>

<p>10.DNS域名服务（/etc/resolv.conf，BIND，PowerDNS， ypbind，nscd）</p>

<p>11.软件包管理（dpkg，rpm）</p>

<p>12.网络信息（网卡，网关，ip，处于waiting状态的连接）</p>

<p>13.打印机（cups）</p>

<p>14.邮件系统（e.g.Postfix，Exim ，Qmail smtpd）</p>

<p>15.防火墙（iptable）</p>

<p>16、web服务器（apache，nignx）安全配置</p>

<p>17.SSH安全配置（例如不运行root远程登录）</p>

<p>18.SNMP安全配置</p>

<p>19.数据库安全配置（MySQL，PostgreSQL，Oracle）</p>

<p>20.LDAP安全配置</p>

<p>21.PHP安全配置</p>

<p>22.Squid安全配置</p>

<p>23.日志文件管理（syslog，logrotate）</p>

<p>24.危险服务 （inetd.conf)</p>

<p>25.系统指纹（/etc/motd /etc/issue /etc/issue.net）</p>

<p>26.定时任务（crontab/cronjob）</p>

<p>27.审计模块是否开启（auditd）</p>

<p>28.时间同步服务（NTP）</p>

<p>29.加密（例如SSL证书有效期）</p>

<p>30.是否应用安全框架（SELinux，AppArmor ，grsecurity）</p>

<p>31.是否有文件系统完整性检测工具（AFICK，AIDE， Osiris，Samhain，Tripwire</p>

<p>32.是否有恶意程序检测工具（chkrootkit，Rootkit Hunter，ClamAV scanner）</p>

<p>33.特定文件的权限是否合理（例如/root/.ssh是否为rwx&mdash;&mdash;）</p>

<p>34.home目录下是否有敏感文件（例如shell history文件内容是否可疑）</p>

<p>35.是否做过内核加固（扫描sysctl内容）</p>

<h2 id="0x01-安装与运行">0x01 安装与运行</h2>

<p>安装</p>

<pre><code>git clone https://github.com/CISOfy/lynis

cd lynis; ./lynis audit system

or

yum -y install epel-release;yum -y install lynis

lynis audi system
</code></pre>

<h2 id="0x02-查看日志敏感信息">0x02 查看日志敏感信息</h2>

<pre><code>grep Warning /var/log/lynis.log

grep Suggestingon /var/log/lynis.log
</code></pre>

<h2 id="0x03-定时扫描">0x03 定时扫描</h2>

<p>创建Lynis计划任务－cron job</p>

<pre><code>如果你想为你的系统创建一个日扫描报告，你可以设置cron：
$ crontab -e

添加cron任务：

30  22  *   *   *   root    /opt/lynis -c -Q --auditor &quot;automated&quot; --cronjob
</code></pre>

<h2 id="0x04-附录">0x04 附录</h2>

<p>安全加固列表</p>

<p>（1）OS加固：debian（真机/虚拟机）</p>

<p>（2）DB加固：mysql3306，PostgreSQL5432，Oracle2483-2484，SQLServer1433-1434</p>

<p>（3）web服务器加固：apache，nignx，lighthttpd</p>

<p>（4）应用程序服务器加固：php</p>

<p>（5）LDAP服务器：OpenLDAP(ldap 389)</p>

<p>（6）DNS服务器，BIND (dns 53)</p>

<p>（7）电子邮件服务器，SendMail(Postfix)：SMTP (smtp 25）</p>

<p>（8）FTP服务器：VSFTPD，Server-U （ftp 21 tftp 69)</p>

<p>（9）Samba服务器：smb协议 (smb445)</p>

<p>（10）NFS服务器(nfs 2049)</p>

<p>（11）Squid服务器</p>

<p>（12）SSH服务器：OpenSSH (ssh 22 telnet23)</p>

<p>（13）Linux防火墙：iptables</p>

<p>（14）VPN服务：OpenVPN (ipsec 500, PPTP 1723, L2TP 1701)</p>

<p>（15）IDS：snort</p>

<p>（16）网络监控：Nagios</p>

<p>（17）网络监控策略：snmp服务 (snmp 161)</p>

<p>（18）SVN服务</p>

<p>（19）RTX</p>

<p>（20）kerberos</p>

<p>（21）SSL：OpenSSL</p>

<p>（22）PAM</p>

<p>（23）DHCP服务器</p>

<p>（24）数据备份</p>

<p>（25）远程桌面VNC (VNC 5900)</p>

<p>（26）NTP(network time protocol) 123</p>

                </section>
            </article>

            
                

            

            

            

            <footer id="footer">
    
    
    <p class="small">
        Powered by <a href="http://www.gohugo.io/">Hugo</a> Theme By <a href="https://github.com/ifishzz">ifish</a>
    </p>
</footer>

        </section>

        <script src="https://ifishzz.github.io//js/jquery-3.3.1.min.js"></script>
<script src="https://ifishzz.github.io//js/main.js"></script>
<script src="https://ifishzz.github.io//js/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




  



<script>
var baiduAnalytics = '';
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?" + baiduAnalytics;
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>


    </body>
</html>
